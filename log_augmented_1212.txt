disable_cp = False
mask_strategy = ['bar']
convert_encoding = OCTMIDI
crop_length = None
2022-12-12 19:05:23 | INFO | fairseq_cli.train | {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': 'json', 'tensorboard_logdir': 'checkpoints/board_apex_M2P_1e-4_small_tmp', 'wandb_project': None, 'azureml_logging': False, 'seed': 7, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': False, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': 'musicbert', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': True}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': True, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'distributed_wrapper': 'DDP', 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'tpu': False, 'distributed_num_procs': 1}, 'dataset': {'_name': None, 'num_workers': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': 32768, 'batch_size': 4, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': 32768, 'batch_size_valid': 4, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 7000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [8], 'lr': [0.0001], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoints/checkpoint_last_musicbert_small.pt', 'finetune_from_model': None, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': True, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'accuracy', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '_xai_apex_M2P_1e-4_small_tmp.pt', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'model_parallel_size': 1, 'distributed_rank': 0}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 1}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='musicbert_small', activation_dropout=0.0, activation_fn='gelu', adam_betas='(0.9, 0.98)', adam_eps=1e-06, adv=False, all_gather_list_size=16384, arch='musicbert_small', attention_dropout=0.1, azureml_logging=False, batch_size=4, batch_size_valid=4, best_checkpoint_metric='accuracy', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='_xai_apex_M2P_1e-4_small_tmp.pt', classification_head_name='xai_head', clip_norm=0.0, cpu=False, criterion='M2P_xai', curriculum=0, data='processed/xai_data_bin_apex_reg_cls_augmented/0', data_buffer_size=10, dataset_impl=None, ddp_backend='c10d', device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=1, distributed_wrapper='DDP', dropout=0.1, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layerdrop=0, encoder_layers=4, encoder_layers_to_keep=None, end_learning_rate=0.0, eos=2, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, force_anneal=None, fp16=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, gen_subset='test', heartbeat_timeout=-1, init_token=0, keep_best_checkpoints=-1, keep_interval_updates=-1, keep_last_epochs=-1, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_format='json', log_interval=100, lr=[0.0001], lr_scheduler='polynomial_decay', max_epoch=0, max_positions=8192, max_tokens=32768, max_tokens_valid=32768, max_update=7000, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, model_parallel_size=1, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_save=False, no_save_optimizer_state=False, no_seed_provided=False, no_shuffle=False, nprocs_per_node=1, num_cls_classes=13, num_reg_classes=-1, num_shards=1, num_workers=0, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, pooler_activation_fn='tanh', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, regression_target=False, required_batch_size_multiple=1, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=True, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, restore_file='checkpoints/checkpoint_last_musicbert_small.pt', save_dir='checkpoints', save_interval=1, save_interval_updates=0, scoring='bleu', seed=7, sentence_avg=False, separator_token=2, shard_id=0, shorten_method='truncate', skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, spectral_norm_classification_head=False, spectral_norm_regression_head=False, stop_min_lr=-1.0, stop_time_hours=0, task='xai', tensorboard_logdir='checkpoints/board_apex_M2P_1e-4_small_tmp', threshold_loss_scale=None, tokenizer=None, total_num_update='7000', tpu=False, train_subset='train', unk=3, untie_weights_roberta=False, update_freq=[8], use_bmuf=False, use_old_adam=False, user_dir='musicbert', valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, wandb_project=None, warmup_updates=300, weight_decay=0.01, zero_sharding='none'), 'task': Namespace(_name='xai', activation_dropout=0.0, activation_fn='gelu', adam_betas='(0.9, 0.98)', adam_eps=1e-06, adv=False, all_gather_list_size=16384, arch='musicbert_small', attention_dropout=0.1, azureml_logging=False, batch_size=4, batch_size_valid=4, best_checkpoint_metric='accuracy', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='_xai_apex_M2P_1e-4_small_tmp.pt', classification_head_name='xai_head', clip_norm=0.0, cpu=False, criterion='M2P_xai', curriculum=0, data='processed/xai_data_bin_apex_reg_cls_augmented/0', data_buffer_size=10, dataset_impl=None, ddp_backend='c10d', device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=1, distributed_wrapper='DDP', dropout=0.1, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layerdrop=0, encoder_layers=4, encoder_layers_to_keep=None, end_learning_rate=0.0, eos=2, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, force_anneal=None, fp16=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, gen_subset='test', heartbeat_timeout=-1, init_token=0, keep_best_checkpoints=-1, keep_interval_updates=-1, keep_last_epochs=-1, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_format='json', log_interval=100, lr=[0.0001], lr_scheduler='polynomial_decay', max_epoch=0, max_positions=8192, max_tokens=32768, max_tokens_valid=32768, max_update=7000, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, model_parallel_size=1, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_save=False, no_save_optimizer_state=False, no_seed_provided=False, no_shuffle=False, nprocs_per_node=1, num_cls_classes=13, num_reg_classes=-1, num_shards=1, num_workers=0, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, pooler_activation_fn='tanh', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, regression_target=False, required_batch_size_multiple=1, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=True, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, restore_file='checkpoints/checkpoint_last_musicbert_small.pt', save_dir='checkpoints', save_interval=1, save_interval_updates=0, scoring='bleu', seed=7, sentence_avg=False, separator_token=2, shard_id=0, shorten_method='truncate', skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, spectral_norm_classification_head=False, spectral_norm_regression_head=False, stop_min_lr=-1.0, stop_time_hours=0, task='xai', tensorboard_logdir='checkpoints/board_apex_M2P_1e-4_small_tmp', threshold_loss_scale=None, tokenizer=None, total_num_update='7000', tpu=False, train_subset='train', unk=3, untie_weights_roberta=False, update_freq=[8], use_bmuf=False, use_old_adam=False, user_dir='musicbert', valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, wandb_project=None, warmup_updates=300, weight_decay=0.01, zero_sharding='none'), 'criterion': Namespace(_name='M2P_xai', activation_dropout=0.0, activation_fn='gelu', adam_betas='(0.9, 0.98)', adam_eps=1e-06, adv=False, all_gather_list_size=16384, arch='musicbert_small', attention_dropout=0.1, azureml_logging=False, batch_size=4, batch_size_valid=4, best_checkpoint_metric='accuracy', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='_xai_apex_M2P_1e-4_small_tmp.pt', classification_head_name='xai_head', clip_norm=0.0, cpu=False, criterion='M2P_xai', curriculum=0, data='processed/xai_data_bin_apex_reg_cls_augmented/0', data_buffer_size=10, dataset_impl=None, ddp_backend='c10d', device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=1, distributed_wrapper='DDP', dropout=0.1, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layerdrop=0, encoder_layers=4, encoder_layers_to_keep=None, end_learning_rate=0.0, eos=2, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, force_anneal=None, fp16=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, gen_subset='test', heartbeat_timeout=-1, init_token=0, keep_best_checkpoints=-1, keep_interval_updates=-1, keep_last_epochs=-1, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_format='json', log_interval=100, lr=[0.0001], lr_scheduler='polynomial_decay', max_epoch=0, max_positions=8192, max_tokens=32768, max_tokens_valid=32768, max_update=7000, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, model_parallel_size=1, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_save=False, no_save_optimizer_state=False, no_seed_provided=False, no_shuffle=False, nprocs_per_node=1, num_cls_classes=13, num_reg_classes=-1, num_shards=1, num_workers=0, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, pooler_activation_fn='tanh', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, regression_target=False, required_batch_size_multiple=1, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=True, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, restore_file='checkpoints/checkpoint_last_musicbert_small.pt', save_dir='checkpoints', save_interval=1, save_interval_updates=0, scoring='bleu', seed=7, sentence_avg=False, separator_token=2, shard_id=0, shorten_method='truncate', skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, spectral_norm_classification_head=False, spectral_norm_regression_head=False, stop_min_lr=-1.0, stop_time_hours=0, task='xai', tensorboard_logdir='checkpoints/board_apex_M2P_1e-4_small_tmp', threshold_loss_scale=None, tokenizer=None, total_num_update='7000', tpu=False, train_subset='train', unk=3, untie_weights_roberta=False, update_freq=[8], use_bmuf=False, use_old_adam=False, user_dir='musicbert', valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, wandb_project=None, warmup_updates=300, weight_decay=0.01, zero_sharding='none'), 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9, 0.98)', 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'tpu': False, 'lr': [0.0001]}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 300, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 7000.0, 'lr': [0.0001]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None}
2022-12-12 19:05:23 | INFO | musicbert | [input] dictionary: 1237 types
2022-12-12 19:05:23 | INFO | musicbert | [label] dictionary: 497 types
2022-12-12 19:05:23 | INFO | fairseq.data.data_utils | loaded 8,870 examples from: processed/xai_data_bin_apex_reg_cls_augmented/0/input0/valid
dataset: 8870
labels: 8870
2022-12-12 19:05:24 | INFO | fairseq_cli.train | MusicBERTModel(
  (encoder): MusicBERTEncoder(
    (sentence_encoder): OctupleEncoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(1237, 512, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(8194, 512, padding_idx=1)
      (emb_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0): TransformerSentenceEncoderLayer(
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        )
        (1): TransformerSentenceEncoderLayer(
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        )
        (2): TransformerSentenceEncoderLayer(
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        )
        (3): TransformerSentenceEncoderLayer(
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        )
      )
      (downsampling): Sequential(
        (0): Linear(in_features=4096, out_features=512, bias=True)
      )
      (upsampling): Sequential(
        (0): Linear(in_features=512, out_features=4096, bias=True)
      )
    )
    (lm_head): RobertaLMHead(
      (dense): Linear(in_features=512, out_features=512, bias=True)
      (layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    )
  )
  (classification_heads): ModuleDict(
    (xai_head): RobertaClassificationHead(
      (dense): Linear(in_features=512, out_features=512, bias=True)
      (dropout): Dropout(p=0.0, inplace=False)
      (out_proj): Linear(in_features=512, out_features=13, bias=True)
    )
  )
  (regression_heads): ModuleDict()
)
2022-12-12 19:05:24 | INFO | fairseq_cli.train | task: MusicBERTSentencePredictionMultilabelTaskXAI
2022-12-12 19:05:24 | INFO | fairseq_cli.train | model: MusicBERTModel
2022-12-12 19:05:24 | INFO | fairseq_cli.train | criterion: MusicBERTM2PCriterionForXAI
2022-12-12 19:05:24 | INFO | fairseq_cli.train | num. model params: 22,805,730 (num. trained: 22,805,730)
2022-12-12 19:05:24 | INFO | fairseq.utils | ***********************CUDA enviroments for all 1 workers***********************
2022-12-12 19:05:24 | INFO | fairseq.utils | rank   0: capabilities =  6.1  ; total memory = 7.927 GB ; name = NVIDIA GeForce GTX 1080                 
2022-12-12 19:05:24 | INFO | fairseq.utils | ***********************CUDA enviroments for all 1 workers***********************
2022-12-12 19:05:24 | INFO | fairseq_cli.train | training on 1 devices (GPUs/TPUs)
2022-12-12 19:05:24 | INFO | fairseq_cli.train | max tokens per GPU = 32768 and batch size per GPU = 4
2022-12-12 19:05:24 | INFO | fairseq.trainer | Preparing to load checkpoint checkpoints/checkpoint_last_musicbert_small.pt
2022-12-12 19:05:24 | INFO | fairseq.trainer | No existing checkpoint found checkpoints/checkpoint_last_musicbert_small.pt
2022-12-12 19:05:24 | INFO | fairseq.trainer | loading train data for epoch 1
2022-12-12 19:05:25 | INFO | fairseq.data.data_utils | loaded 79,823 examples from: processed/xai_data_bin_apex_reg_cls_augmented/0/input0/train
dataset: 79823
labels: 79823
2022-12-12 19:05:26 | INFO | fairseq.trainer | begin training epoch 1
2022-12-12 19:05:39 | INFO | train_inner | {"epoch": 1, "update": 0.04, "loss": "3.502", "nll_loss": "0.137", "accuracy": "15.6", "wps": "6105.2", "ups": "7.48", "wpb": "816.1", "bsz": "32", "num_updates": "100", "lr": "3.33333e-05", "gnorm": "3.304", "train_wall": "14", "wall": "15"}
2022-12-12 19:05:53 | INFO | train_inner | {"epoch": 1, "update": 0.08, "loss": "2.965", "nll_loss": "0.116", "accuracy": "24.8", "wps": "6178.5", "ups": "7.59", "wpb": "814.5", "bsz": "32", "num_updates": "200", "lr": "6.66667e-05", "gnorm": "2.897", "train_wall": "13", "wall": "28"}
2022-12-12 19:06:07 | INFO | train_inner | {"epoch": 1, "update": 0.12, "loss": "2.912", "nll_loss": "0.114", "accuracy": "24", "wps": "5894.4", "ups": "7.22", "wpb": "816.1", "bsz": "32", "num_updates": "300", "lr": "0.0001", "gnorm": "3.065", "train_wall": "14", "wall": "42"}
2022-12-12 19:06:20 | INFO | train_inner | {"epoch": 1, "update": 0.16, "loss": "2.974", "nll_loss": "0.116", "accuracy": "22.1", "wps": "6207.2", "ups": "7.6", "wpb": "816.8", "bsz": "32", "num_updates": "400", "lr": "9.85075e-05", "gnorm": "3.119", "train_wall": "13", "wall": "55"}
2022-12-12 19:06:33 | INFO | train_inner | {"epoch": 1, "update": 0.2, "loss": "2.915", "nll_loss": "0.114", "accuracy": "22.9", "wps": "6114.4", "ups": "7.49", "wpb": "816.8", "bsz": "32", "num_updates": "500", "lr": "9.70149e-05", "gnorm": "3.222", "train_wall": "13", "wall": "69"}
2022-12-12 19:06:47 | INFO | train_inner | {"epoch": 1, "update": 0.24, "loss": "2.82", "nll_loss": "0.111", "accuracy": "28", "wps": "5872.9", "ups": "7.19", "wpb": "816.6", "bsz": "32", "num_updates": "600", "lr": "9.55224e-05", "gnorm": "3.222", "train_wall": "14", "wall": "83"}
2022-12-12 19:07:01 | INFO | train_inner | {"epoch": 1, "update": 0.281, "loss": "2.726", "nll_loss": "0.107", "accuracy": "29.9", "wps": "5901.8", "ups": "7.25", "wpb": "814.5", "bsz": "32", "num_updates": "700", "lr": "9.40299e-05", "gnorm": "3.318", "train_wall": "14", "wall": "96"}
2022-12-12 19:07:15 | INFO | train_inner | {"epoch": 1, "update": 0.321, "loss": "2.725", "nll_loss": "0.107", "accuracy": "30.6", "wps": "5961.4", "ups": "7.31", "wpb": "815.5", "bsz": "32", "num_updates": "800", "lr": "9.25373e-05", "gnorm": "3.595", "train_wall": "14", "wall": "110"}
2022-12-12 19:07:28 | INFO | train_inner | {"epoch": 1, "update": 0.361, "loss": "2.718", "nll_loss": "0.107", "accuracy": "30.1", "wps": "5937.5", "ups": "7.28", "wpb": "815.1", "bsz": "32", "num_updates": "900", "lr": "9.10448e-05", "gnorm": "3.956", "train_wall": "14", "wall": "124"}
2022-12-12 19:07:42 | INFO | train_inner | {"epoch": 1, "update": 0.401, "loss": "2.673", "nll_loss": "0.105", "accuracy": "30.6", "wps": "5904", "ups": "7.23", "wpb": "816.6", "bsz": "32", "num_updates": "1000", "lr": "8.95522e-05", "gnorm": "4.349", "train_wall": "14", "wall": "138"}
2022-12-12 19:07:56 | INFO | train_inner | {"epoch": 1, "update": 0.441, "loss": "2.59", "nll_loss": "0.102", "accuracy": "33.9", "wps": "5980.4", "ups": "7.33", "wpb": "816.3", "bsz": "32", "num_updates": "1100", "lr": "8.80597e-05", "gnorm": "4.912", "train_wall": "14", "wall": "151"}
2022-12-12 19:08:10 | INFO | train_inner | {"epoch": 1, "update": 0.481, "loss": "2.492", "nll_loss": "0.098", "accuracy": "35", "wps": "5990.4", "ups": "7.34", "wpb": "816.3", "bsz": "32", "num_updates": "1200", "lr": "8.65672e-05", "gnorm": "5.229", "train_wall": "13", "wall": "165"}
2022-12-12 19:08:23 | INFO | train_inner | {"epoch": 1, "update": 0.521, "loss": "2.423", "nll_loss": "0.095", "accuracy": "37.8", "wps": "6005.5", "ups": "7.37", "wpb": "815.1", "bsz": "32", "num_updates": "1300", "lr": "8.50746e-05", "gnorm": "5.819", "train_wall": "13", "wall": "179"}
2022-12-12 19:08:37 | INFO | train_inner | {"epoch": 1, "update": 0.561, "loss": "2.247", "nll_loss": "0.088", "accuracy": "42.7", "wps": "5993.1", "ups": "7.34", "wpb": "816.1", "bsz": "32", "num_updates": "1400", "lr": "8.35821e-05", "gnorm": "6.508", "train_wall": "13", "wall": "192"}
2022-12-12 19:08:51 | INFO | train_inner | {"epoch": 1, "update": 0.601, "loss": "2.152", "nll_loss": "0.084", "accuracy": "44.6", "wps": "5997", "ups": "7.34", "wpb": "816.6", "bsz": "32", "num_updates": "1500", "lr": "8.20896e-05", "gnorm": "7.425", "train_wall": "13", "wall": "206"}
2022-12-12 19:09:04 | INFO | train_inner | {"epoch": 1, "update": 0.641, "loss": "2.045", "nll_loss": "0.08", "accuracy": "48.2", "wps": "6128.8", "ups": "7.5", "wpb": "817.2", "bsz": "32", "num_updates": "1600", "lr": "8.0597e-05", "gnorm": "8.411", "train_wall": "13", "wall": "219"}
2022-12-12 19:09:18 | INFO | train_inner | {"epoch": 1, "update": 0.681, "loss": "1.861", "nll_loss": "0.073", "accuracy": "52.5", "wps": "5900.9", "ups": "7.24", "wpb": "815.5", "bsz": "32", "num_updates": "1700", "lr": "7.91045e-05", "gnorm": "9.03", "train_wall": "14", "wall": "233"}
2022-12-12 19:09:32 | INFO | train_inner | {"epoch": 1, "update": 0.721, "loss": "1.694", "nll_loss": "0.066", "accuracy": "57.5", "wps": "5894.7", "ups": "7.22", "wpb": "816.5", "bsz": "32", "num_updates": "1800", "lr": "7.76119e-05", "gnorm": "9.73", "train_wall": "14", "wall": "247"}
2022-12-12 19:09:45 | INFO | train_inner | {"epoch": 1, "update": 0.762, "loss": "1.575", "nll_loss": "0.062", "accuracy": "61", "wps": "5922.1", "ups": "7.26", "wpb": "816", "bsz": "32", "num_updates": "1900", "lr": "7.61194e-05", "gnorm": "10.314", "train_wall": "14", "wall": "261"}
2022-12-12 19:09:59 | INFO | train_inner | {"epoch": 1, "update": 0.802, "loss": "1.4", "nll_loss": "0.055", "accuracy": "65.7", "wps": "5817.1", "ups": "7.13", "wpb": "816.4", "bsz": "32", "num_updates": "2000", "lr": "7.46269e-05", "gnorm": "10.872", "train_wall": "14", "wall": "275"}
2022-12-12 19:10:13 | INFO | train_inner | {"epoch": 1, "update": 0.842, "loss": "1.277", "nll_loss": "0.05", "accuracy": "68.5", "wps": "5970.3", "ups": "7.31", "wpb": "816.8", "bsz": "32", "num_updates": "2100", "lr": "7.31343e-05", "gnorm": "10.916", "train_wall": "14", "wall": "289"}
2022-12-12 19:10:27 | INFO | train_inner | {"epoch": 1, "update": 0.882, "loss": "1.18", "nll_loss": "0.046", "accuracy": "71.2", "wps": "5977.4", "ups": "7.33", "wpb": "815.8", "bsz": "32", "num_updates": "2200", "lr": "7.16418e-05", "gnorm": "11.599", "train_wall": "14", "wall": "302"}
2022-12-12 19:10:41 | INFO | train_inner | {"epoch": 1, "update": 0.922, "loss": "0.946", "nll_loss": "0.037", "accuracy": "77.1", "wps": "5938.4", "ups": "7.28", "wpb": "815.8", "bsz": "32", "num_updates": "2300", "lr": "7.01493e-05", "gnorm": "11.163", "train_wall": "14", "wall": "316"}
2022-12-12 19:10:54 | INFO | train_inner | {"epoch": 1, "update": 0.962, "loss": "0.962", "nll_loss": "0.038", "accuracy": "77.1", "wps": "5939.9", "ups": "7.28", "wpb": "815.6", "bsz": "32", "num_updates": "2400", "lr": "6.86567e-05", "gnorm": "12.346", "train_wall": "14", "wall": "330"}
2022-12-12 19:11:07 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-12-12 19:11:20 | INFO | valid | {"epoch": 1, "valid_loss": "0.802", "valid_nll_loss": "0.031", "valid_accuracy": "80.4", "valid_wps": "18143.2", "valid_wpb": "102.1", "valid_bsz": "4", "valid_num_updates": "2495"}
2022-12-12 19:11:20 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 1 @ 2495 updates
2022-12-12 19:11:23 | INFO | fairseq.trainer | Finished saving checkpoint to checkpoints/checkpoint_best_xai_apex_M2P_1e-4_small_tmp.pt.pt
2022-12-12 19:11:28 | INFO | fairseq.checkpoint_utils | Saved checkpoint checkpoints/checkpoint_best_xai_apex_M2P_1e-4_small_tmp.pt.pt (epoch 1 @ 2495 updates, score 80.4) (writing took 8.315142538864166 seconds)
2022-12-12 19:11:28 | INFO | fairseq_cli.train | end of epoch 1 (average epoch stats below)
2022-12-12 19:11:28 | INFO | train | {"epoch": 1, "train_loss": "2.189", "train_nll_loss": "0.086", "train_accuracy": "44.4", "train_wps": "5620", "train_ups": "6.89", "train_wpb": "815.9", "train_bsz": "32", "train_num_updates": "2495", "train_lr": "6.72388e-05", "train_gnorm": "6.826", "train_train_wall": "337", "train_wall": "364"}
2022-12-12 19:11:28 | INFO | fairseq.trainer | begin training epoch 2
2022-12-12 19:11:29 | INFO | train_inner | {"epoch": 2, "update": 1.002, "loss": "0.864", "nll_loss": "0.034", "accuracy": "79.7", "wps": "2343.4", "ups": "2.89", "wpb": "811.9", "bsz": "31.8", "num_updates": "2500", "lr": "6.71642e-05", "gnorm": "12.585", "train_wall": "14", "wall": "365"}
2022-12-12 19:11:43 | INFO | train_inner | {"epoch": 2, "update": 1.042, "loss": "0.583", "nll_loss": "0.023", "accuracy": "86.7", "wps": "5902.9", "ups": "7.23", "wpb": "816.2", "bsz": "32", "num_updates": "2600", "lr": "6.56716e-05", "gnorm": "10.436", "train_wall": "14", "wall": "379"}
2022-12-12 19:11:57 | INFO | train_inner | {"epoch": 2, "update": 1.082, "loss": "0.588", "nll_loss": "0.023", "accuracy": "86.8", "wps": "6058.7", "ups": "7.42", "wpb": "816.3", "bsz": "32", "num_updates": "2700", "lr": "6.41791e-05", "gnorm": "11.855", "train_wall": "13", "wall": "392"}
2022-12-12 19:12:11 | INFO | train_inner | {"epoch": 2, "update": 1.122, "loss": "0.538", "nll_loss": "0.021", "accuracy": "87.2", "wps": "5794.2", "ups": "7.11", "wpb": "814.7", "bsz": "32", "num_updates": "2800", "lr": "6.26866e-05", "gnorm": "12.48", "train_wall": "14", "wall": "406"}
2022-12-12 19:12:25 | INFO | train_inner | {"epoch": 2, "update": 1.162, "loss": "0.437", "nll_loss": "0.017", "accuracy": "89.8", "wps": "5895.3", "ups": "7.22", "wpb": "816.7", "bsz": "32", "num_updates": "2900", "lr": "6.1194e-05", "gnorm": "11.094", "train_wall": "14", "wall": "420"}
2022-12-12 19:12:38 | INFO | train_inner | {"epoch": 2, "update": 1.202, "loss": "0.376", "nll_loss": "0.015", "accuracy": "91.3", "wps": "6051", "ups": "7.43", "wpb": "814.6", "bsz": "32", "num_updates": "3000", "lr": "5.97015e-05", "gnorm": "10.842", "train_wall": "13", "wall": "434"}
2022-12-12 19:12:52 | INFO | train_inner | {"epoch": 2, "update": 1.242, "loss": "0.379", "nll_loss": "0.015", "accuracy": "91.8", "wps": "5968", "ups": "7.33", "wpb": "814.7", "bsz": "32", "num_updates": "3100", "lr": "5.8209e-05", "gnorm": "11.385", "train_wall": "13", "wall": "447"}
2022-12-12 19:13:05 | INFO | train_inner | {"epoch": 2, "update": 1.283, "loss": "0.322", "nll_loss": "0.013", "accuracy": "93.2", "wps": "5942.6", "ups": "7.29", "wpb": "814.9", "bsz": "32", "num_updates": "3200", "lr": "5.67164e-05", "gnorm": "10.232", "train_wall": "14", "wall": "461"}
2022-12-12 19:13:20 | INFO | train_inner | {"epoch": 2, "update": 1.323, "loss": "0.276", "nll_loss": "0.011", "accuracy": "94.7", "wps": "5704.8", "ups": "7", "wpb": "815.5", "bsz": "32", "num_updates": "3300", "lr": "5.52239e-05", "gnorm": "9.76", "train_wall": "14", "wall": "475"}
2022-12-12 19:13:33 | INFO | train_inner | {"epoch": 2, "update": 1.363, "loss": "0.286", "nll_loss": "0.011", "accuracy": "93.8", "wps": "5982.4", "ups": "7.34", "wpb": "815.4", "bsz": "32", "num_updates": "3400", "lr": "5.37313e-05", "gnorm": "10.644", "train_wall": "13", "wall": "489"}
2022-12-12 19:13:47 | INFO | train_inner | {"epoch": 2, "update": 1.403, "loss": "0.254", "nll_loss": "0.01", "accuracy": "94.6", "wps": "5865.7", "ups": "7.19", "wpb": "815.5", "bsz": "32", "num_updates": "3500", "lr": "5.22388e-05", "gnorm": "10.284", "train_wall": "14", "wall": "503"}
2022-12-12 19:14:01 | INFO | train_inner | {"epoch": 2, "update": 1.443, "loss": "0.222", "nll_loss": "0.009", "accuracy": "95.2", "wps": "5987.3", "ups": "7.34", "wpb": "816.1", "bsz": "32", "num_updates": "3600", "lr": "5.07463e-05", "gnorm": "9.627", "train_wall": "13", "wall": "517"}
2022-12-12 19:14:15 | INFO | train_inner | {"epoch": 2, "update": 1.483, "loss": "0.217", "nll_loss": "0.009", "accuracy": "95.4", "wps": "5964.8", "ups": "7.31", "wpb": "816.4", "bsz": "32", "num_updates": "3700", "lr": "4.92537e-05", "gnorm": "9.908", "train_wall": "14", "wall": "530"}
2022-12-12 19:14:29 | INFO | train_inner | {"epoch": 2, "update": 1.523, "loss": "0.188", "nll_loss": "0.007", "accuracy": "96.2", "wps": "5828.7", "ups": "7.14", "wpb": "816.4", "bsz": "32", "num_updates": "3800", "lr": "4.77612e-05", "gnorm": "8.784", "train_wall": "14", "wall": "544"}
2022-12-12 19:14:42 | INFO | train_inner | {"epoch": 2, "update": 1.563, "loss": "0.186", "nll_loss": "0.007", "accuracy": "96.3", "wps": "6063.8", "ups": "7.43", "wpb": "816.6", "bsz": "32", "num_updates": "3900", "lr": "4.62687e-05", "gnorm": "9.073", "train_wall": "13", "wall": "558"}
2022-12-12 19:14:56 | INFO | train_inner | {"epoch": 2, "update": 1.603, "loss": "0.15", "nll_loss": "0.006", "accuracy": "97", "wps": "6073.2", "ups": "7.45", "wpb": "815.7", "bsz": "32", "num_updates": "4000", "lr": "4.47761e-05", "gnorm": "7.75", "train_wall": "13", "wall": "571"}
2022-12-12 19:15:10 | INFO | train_inner | {"epoch": 2, "update": 1.643, "loss": "0.158", "nll_loss": "0.006", "accuracy": "96.9", "wps": "5945.2", "ups": "7.28", "wpb": "816.7", "bsz": "32", "num_updates": "4100", "lr": "4.32836e-05", "gnorm": "7.852", "train_wall": "14", "wall": "585"}
2022-12-12 19:15:24 | INFO | train_inner | {"epoch": 2, "update": 1.683, "loss": "0.149", "nll_loss": "0.006", "accuracy": "97.4", "wps": "5861.7", "ups": "7.19", "wpb": "815", "bsz": "32", "num_updates": "4200", "lr": "4.1791e-05", "gnorm": "7.506", "train_wall": "14", "wall": "599"}
2022-12-12 19:15:37 | INFO | train_inner | {"epoch": 2, "update": 1.723, "loss": "0.107", "nll_loss": "0.004", "accuracy": "98", "wps": "6045.8", "ups": "7.4", "wpb": "817.2", "bsz": "32", "num_updates": "4300", "lr": "4.02985e-05", "gnorm": "5.967", "train_wall": "13", "wall": "613"}
2022-12-12 19:15:51 | INFO | train_inner | {"epoch": 2, "update": 1.764, "loss": "0.123", "nll_loss": "0.005", "accuracy": "97.7", "wps": "5986.7", "ups": "7.33", "wpb": "816.5", "bsz": "32", "num_updates": "4400", "lr": "3.8806e-05", "gnorm": "6.278", "train_wall": "13", "wall": "626"}
2022-12-12 19:16:05 | INFO | train_inner | {"epoch": 2, "update": 1.804, "loss": "0.109", "nll_loss": "0.004", "accuracy": "98", "wps": "5937.6", "ups": "7.28", "wpb": "815.8", "bsz": "32", "num_updates": "4500", "lr": "3.73134e-05", "gnorm": "6.478", "train_wall": "14", "wall": "640"}
2022-12-12 19:16:18 | INFO | train_inner | {"epoch": 2, "update": 1.844, "loss": "0.131", "nll_loss": "0.005", "accuracy": "97.6", "wps": "5939.2", "ups": "7.27", "wpb": "817.1", "bsz": "32", "num_updates": "4600", "lr": "3.58209e-05", "gnorm": "6.463", "train_wall": "14", "wall": "654"}
2022-12-12 19:16:32 | INFO | train_inner | {"epoch": 2, "update": 1.884, "loss": "0.103", "nll_loss": "0.004", "accuracy": "98.2", "wps": "5792.5", "ups": "7.11", "wpb": "815.1", "bsz": "32", "num_updates": "4700", "lr": "3.43284e-05", "gnorm": "6.047", "train_wall": "14", "wall": "668"}
2022-12-12 19:16:46 | INFO | train_inner | {"epoch": 2, "update": 1.924, "loss": "0.104", "nll_loss": "0.004", "accuracy": "98.3", "wps": "5985.2", "ups": "7.32", "wpb": "817.3", "bsz": "32", "num_updates": "4800", "lr": "3.28358e-05", "gnorm": "5.803", "train_wall": "14", "wall": "682"}
2022-12-12 19:17:00 | INFO | train_inner | {"epoch": 2, "update": 1.964, "loss": "0.094", "nll_loss": "0.004", "accuracy": "98.2", "wps": "5804.5", "ups": "7.1", "wpb": "817.4", "bsz": "32", "num_updates": "4900", "lr": "3.13433e-05", "gnorm": "5.725", "train_wall": "14", "wall": "696"}
2022-12-12 19:17:13 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-12-12 19:17:25 | INFO | valid | {"epoch": 2, "valid_loss": "0.051", "valid_nll_loss": "0.002", "valid_accuracy": "99.3", "valid_wps": "18091.8", "valid_wpb": "102.1", "valid_bsz": "4", "valid_num_updates": "4990", "valid_best_accuracy": "99.3"}
2022-12-12 19:17:25 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 4990 updates
2022-12-12 19:17:28 | INFO | fairseq.trainer | Finished saving checkpoint to checkpoints/checkpoint_best_xai_apex_M2P_1e-4_small_tmp.pt.pt
2022-12-12 19:17:34 | INFO | fairseq.checkpoint_utils | Saved checkpoint checkpoints/checkpoint_best_xai_apex_M2P_1e-4_small_tmp.pt.pt (epoch 2 @ 4990 updates, score 99.3) (writing took 8.436510278843343 seconds)
2022-12-12 19:17:34 | INFO | fairseq_cli.train | end of epoch 2 (average epoch stats below)
2022-12-12 19:17:35 | INFO | train | {"epoch": 2, "train_loss": "0.248", "train_nll_loss": "0.01", "train_accuracy": "94.7", "train_wps": "5572.8", "train_ups": "6.83", "train_wpb": "815.9", "train_bsz": "32", "train_num_updates": "4990", "train_lr": "3e-05", "train_gnorm": "8.75", "train_train_wall": "339", "train_wall": "729"}
2022-12-12 19:17:35 | INFO | fairseq.trainer | begin training epoch 3
2022-12-12 19:17:36 | INFO | train_inner | {"epoch": 3, "update": 2.004, "loss": "0.088", "nll_loss": "0.003", "accuracy": "98.4", "wps": "2280.6", "ups": "2.81", "wpb": "812.4", "bsz": "31.8", "num_updates": "5000", "lr": "2.98507e-05", "gnorm": "5.874", "train_wall": "14", "wall": "731"}
2022-12-12 19:17:50 | INFO | train_inner | {"epoch": 3, "update": 2.044, "loss": "0.087", "nll_loss": "0.003", "accuracy": "98.7", "wps": "5980.2", "ups": "7.32", "wpb": "816.4", "bsz": "32", "num_updates": "5100", "lr": "2.83582e-05", "gnorm": "5.078", "train_wall": "13", "wall": "745"}
2022-12-12 19:18:03 | INFO | train_inner | {"epoch": 3, "update": 2.084, "loss": "0.061", "nll_loss": "0.002", "accuracy": "98.7", "wps": "5894.7", "ups": "7.21", "wpb": "817.3", "bsz": "32", "num_updates": "5200", "lr": "2.68657e-05", "gnorm": "4.553", "train_wall": "14", "wall": "759"}
2022-12-12 19:18:18 | INFO | train_inner | {"epoch": 3, "update": 2.124, "loss": "0.037", "nll_loss": "0.001", "accuracy": "99.2", "wps": "5784.8", "ups": "7.09", "wpb": "815.4", "bsz": "32", "num_updates": "5300", "lr": "2.53731e-05", "gnorm": "3.791", "train_wall": "14", "wall": "773"}
2022-12-12 19:18:31 | INFO | train_inner | {"epoch": 3, "update": 2.164, "loss": "0.057", "nll_loss": "0.002", "accuracy": "99", "wps": "6043.5", "ups": "7.4", "wpb": "816.2", "bsz": "32", "num_updates": "5400", "lr": "2.38806e-05", "gnorm": "4.32", "train_wall": "13", "wall": "787"}
2022-12-12 19:18:45 | INFO | train_inner | {"epoch": 3, "update": 2.204, "loss": "0.053", "nll_loss": "0.002", "accuracy": "98.9", "wps": "6014.4", "ups": "7.37", "wpb": "815.8", "bsz": "32", "num_updates": "5500", "lr": "2.23881e-05", "gnorm": "4.162", "train_wall": "13", "wall": "800"}
2022-12-12 19:18:59 | INFO | train_inner | {"epoch": 3, "update": 2.244, "loss": "0.049", "nll_loss": "0.002", "accuracy": "99.1", "wps": "5784.2", "ups": "7.09", "wpb": "815.8", "bsz": "32", "num_updates": "5600", "lr": "2.08955e-05", "gnorm": "3.827", "train_wall": "14", "wall": "814"}
2022-12-12 19:19:13 | INFO | train_inner | {"epoch": 3, "update": 2.285, "loss": "0.039", "nll_loss": "0.002", "accuracy": "99.4", "wps": "5896.8", "ups": "7.24", "wpb": "815", "bsz": "32", "num_updates": "5700", "lr": "1.9403e-05", "gnorm": "3.303", "train_wall": "14", "wall": "828"}
2022-12-12 19:19:27 | INFO | train_inner | {"epoch": 3, "update": 2.325, "loss": "0.069", "nll_loss": "0.003", "accuracy": "99", "wps": "5869.5", "ups": "7.19", "wpb": "816.6", "bsz": "32", "num_updates": "5800", "lr": "1.79104e-05", "gnorm": "3.927", "train_wall": "14", "wall": "842"}
2022-12-12 19:19:41 | INFO | train_inner | {"epoch": 3, "update": 2.365, "loss": "0.063", "nll_loss": "0.002", "accuracy": "99", "wps": "5810.4", "ups": "7.13", "wpb": "815.5", "bsz": "32", "num_updates": "5900", "lr": "1.64179e-05", "gnorm": "3.206", "train_wall": "14", "wall": "856"}
2022-12-12 19:19:54 | INFO | train_inner | {"epoch": 3, "update": 2.405, "loss": "0.026", "nll_loss": "0.001", "accuracy": "99.6", "wps": "6078.9", "ups": "7.46", "wpb": "815.1", "bsz": "32", "num_updates": "6000", "lr": "1.49254e-05", "gnorm": "1.981", "train_wall": "13", "wall": "870"}
2022-12-12 19:20:08 | INFO | train_inner | {"epoch": 3, "update": 2.445, "loss": "0.048", "nll_loss": "0.002", "accuracy": "99.2", "wps": "5970.5", "ups": "7.33", "wpb": "814.8", "bsz": "32", "num_updates": "6100", "lr": "1.34328e-05", "gnorm": "3.236", "train_wall": "14", "wall": "883"}
2022-12-12 19:20:22 | INFO | train_inner | {"epoch": 3, "update": 2.485, "loss": "0.044", "nll_loss": "0.002", "accuracy": "99.3", "wps": "5819.7", "ups": "7.13", "wpb": "815.7", "bsz": "32", "num_updates": "6200", "lr": "1.19403e-05", "gnorm": "2.694", "train_wall": "14", "wall": "897"}
2022-12-12 19:20:35 | INFO | train_inner | {"epoch": 3, "update": 2.525, "loss": "0.034", "nll_loss": "0.001", "accuracy": "99.5", "wps": "6055.5", "ups": "7.41", "wpb": "817", "bsz": "32", "num_updates": "6300", "lr": "1.04478e-05", "gnorm": "2.249", "train_wall": "13", "wall": "911"}
2022-12-12 19:20:49 | INFO | train_inner | {"epoch": 3, "update": 2.565, "loss": "0.047", "nll_loss": "0.002", "accuracy": "99.2", "wps": "6142", "ups": "7.52", "wpb": "817", "bsz": "32", "num_updates": "6400", "lr": "8.95522e-06", "gnorm": "2.919", "train_wall": "13", "wall": "924"}
2022-12-12 19:21:02 | INFO | train_inner | {"epoch": 3, "update": 2.605, "loss": "0.036", "nll_loss": "0.001", "accuracy": "99.6", "wps": "6019.1", "ups": "7.37", "wpb": "816.9", "bsz": "32", "num_updates": "6500", "lr": "7.46269e-06", "gnorm": "2.013", "train_wall": "13", "wall": "938"}
2022-12-12 19:21:16 | INFO | train_inner | {"epoch": 3, "update": 2.645, "loss": "0.031", "nll_loss": "0.001", "accuracy": "99.6", "wps": "5830.4", "ups": "7.15", "wpb": "815.7", "bsz": "32", "num_updates": "6600", "lr": "5.97015e-06", "gnorm": "1.785", "train_wall": "14", "wall": "952"}
2022-12-12 19:21:30 | INFO | train_inner | {"epoch": 3, "update": 2.685, "loss": "0.028", "nll_loss": "0.001", "accuracy": "99.6", "wps": "5814.8", "ups": "7.12", "wpb": "816.1", "bsz": "32", "num_updates": "6700", "lr": "4.47761e-06", "gnorm": "2.252", "train_wall": "14", "wall": "966"}
2022-12-12 19:21:44 | INFO | train_inner | {"epoch": 3, "update": 2.725, "loss": "0.021", "nll_loss": "0.001", "accuracy": "99.7", "wps": "5899.4", "ups": "7.23", "wpb": "815.6", "bsz": "32", "num_updates": "6800", "lr": "2.98507e-06", "gnorm": "1.558", "train_wall": "14", "wall": "980"}
2022-12-12 19:21:58 | INFO | train_inner | {"epoch": 3, "update": 2.766, "loss": "0.036", "nll_loss": "0.001", "accuracy": "99.4", "wps": "5964.5", "ups": "7.3", "wpb": "817", "bsz": "32", "num_updates": "6900", "lr": "1.49254e-06", "gnorm": "2.386", "train_wall": "14", "wall": "994"}
2022-12-12 19:22:12 | INFO | train_inner | {"epoch": 3, "update": 2.806, "loss": "0.021", "nll_loss": "0.001", "accuracy": "99.6", "wps": "5920", "ups": "7.26", "wpb": "815.1", "bsz": "32", "num_updates": "7000", "lr": "0", "gnorm": "2.204", "train_wall": "14", "wall": "1007"}
2022-12-12 19:22:12 | INFO | fairseq_cli.train | Stopping training due to num_updates: 7000 >= max_update: 7000
2022-12-12 19:22:12 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-12-12 19:22:24 | INFO | valid | {"epoch": 3, "valid_loss": "0.039", "valid_nll_loss": "0.002", "valid_accuracy": "99.5", "valid_wps": "18108.9", "valid_wpb": "102.1", "valid_bsz": "4", "valid_num_updates": "7000", "valid_best_accuracy": "99.5"}
2022-12-12 19:22:24 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 3 @ 7000 updates
2022-12-12 19:22:27 | INFO | fairseq.trainer | Finished saving checkpoint to checkpoints/checkpoint_best_xai_apex_M2P_1e-4_small_tmp.pt.pt
2022-12-12 19:22:33 | INFO | fairseq.checkpoint_utils | Saved checkpoint checkpoints/checkpoint_best_xai_apex_M2P_1e-4_small_tmp.pt.pt (epoch 3 @ 7000 updates, score 99.5) (writing took 8.489374577067792 seconds)
2022-12-12 19:22:33 | INFO | fairseq_cli.train | end of epoch 3 (average epoch stats below)
2022-12-12 19:22:34 | INFO | train | {"epoch": 3, "train_loss": "0.045", "train_nll_loss": "0.002", "train_accuracy": "99.3", "train_wps": "5496.6", "train_ups": "6.74", "train_wpb": "816", "train_bsz": "32", "train_num_updates": "7000", "train_lr": "0", "train_gnorm": "3.079", "train_train_wall": "274", "train_wall": "1028"}
2022-12-12 19:22:34 | INFO | fairseq_cli.train | done training in 1028.2 seconds
disable_cp = False
mask_strategy = ['bar']
convert_encoding = OCTMIDI
crop_length = None
2022-12-12 19:22:43 | INFO | fairseq_cli.train | {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': 'json', 'tensorboard_logdir': 'checkpoints/board_apex_M2P_1e-5_small_tmp', 'wandb_project': None, 'azureml_logging': False, 'seed': 7, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': False, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': 'musicbert', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': True}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': True, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'distributed_wrapper': 'DDP', 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'tpu': False, 'distributed_num_procs': 1}, 'dataset': {'_name': None, 'num_workers': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': 32768, 'batch_size': 4, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': 32768, 'batch_size_valid': 4, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 7000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [8], 'lr': [1e-05], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoints/checkpoint_last_musicbert_small.pt', 'finetune_from_model': None, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': True, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'accuracy', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '_xai_apex_M2P_1e-5_small_tmp.pt', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'model_parallel_size': 1, 'distributed_rank': 0}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 1}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='musicbert_small', activation_dropout=0.0, activation_fn='gelu', adam_betas='(0.9, 0.98)', adam_eps=1e-06, adv=False, all_gather_list_size=16384, arch='musicbert_small', attention_dropout=0.1, azureml_logging=False, batch_size=4, batch_size_valid=4, best_checkpoint_metric='accuracy', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='_xai_apex_M2P_1e-5_small_tmp.pt', classification_head_name='xai_head', clip_norm=0.0, cpu=False, criterion='M2P_xai', curriculum=0, data='processed/xai_data_bin_apex_reg_cls_augmented/0', data_buffer_size=10, dataset_impl=None, ddp_backend='c10d', device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=1, distributed_wrapper='DDP', dropout=0.1, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layerdrop=0, encoder_layers=4, encoder_layers_to_keep=None, end_learning_rate=0.0, eos=2, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, force_anneal=None, fp16=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, gen_subset='test', heartbeat_timeout=-1, init_token=0, keep_best_checkpoints=-1, keep_interval_updates=-1, keep_last_epochs=-1, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_format='json', log_interval=100, lr=[1e-05], lr_scheduler='polynomial_decay', max_epoch=0, max_positions=8192, max_tokens=32768, max_tokens_valid=32768, max_update=7000, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, model_parallel_size=1, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_save=False, no_save_optimizer_state=False, no_seed_provided=False, no_shuffle=False, nprocs_per_node=1, num_cls_classes=13, num_reg_classes=-1, num_shards=1, num_workers=0, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, pooler_activation_fn='tanh', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, regression_target=False, required_batch_size_multiple=1, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=True, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, restore_file='checkpoints/checkpoint_last_musicbert_small.pt', save_dir='checkpoints', save_interval=1, save_interval_updates=0, scoring='bleu', seed=7, sentence_avg=False, separator_token=2, shard_id=0, shorten_method='truncate', skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, spectral_norm_classification_head=False, spectral_norm_regression_head=False, stop_min_lr=-1.0, stop_time_hours=0, task='xai', tensorboard_logdir='checkpoints/board_apex_M2P_1e-5_small_tmp', threshold_loss_scale=None, tokenizer=None, total_num_update='7000', tpu=False, train_subset='train', unk=3, untie_weights_roberta=False, update_freq=[8], use_bmuf=False, use_old_adam=False, user_dir='musicbert', valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, wandb_project=None, warmup_updates=300, weight_decay=0.01, zero_sharding='none'), 'task': Namespace(_name='xai', activation_dropout=0.0, activation_fn='gelu', adam_betas='(0.9, 0.98)', adam_eps=1e-06, adv=False, all_gather_list_size=16384, arch='musicbert_small', attention_dropout=0.1, azureml_logging=False, batch_size=4, batch_size_valid=4, best_checkpoint_metric='accuracy', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='_xai_apex_M2P_1e-5_small_tmp.pt', classification_head_name='xai_head', clip_norm=0.0, cpu=False, criterion='M2P_xai', curriculum=0, data='processed/xai_data_bin_apex_reg_cls_augmented/0', data_buffer_size=10, dataset_impl=None, ddp_backend='c10d', device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=1, distributed_wrapper='DDP', dropout=0.1, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layerdrop=0, encoder_layers=4, encoder_layers_to_keep=None, end_learning_rate=0.0, eos=2, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, force_anneal=None, fp16=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, gen_subset='test', heartbeat_timeout=-1, init_token=0, keep_best_checkpoints=-1, keep_interval_updates=-1, keep_last_epochs=-1, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_format='json', log_interval=100, lr=[1e-05], lr_scheduler='polynomial_decay', max_epoch=0, max_positions=8192, max_tokens=32768, max_tokens_valid=32768, max_update=7000, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, model_parallel_size=1, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_save=False, no_save_optimizer_state=False, no_seed_provided=False, no_shuffle=False, nprocs_per_node=1, num_cls_classes=13, num_reg_classes=-1, num_shards=1, num_workers=0, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, pooler_activation_fn='tanh', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, regression_target=False, required_batch_size_multiple=1, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=True, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, restore_file='checkpoints/checkpoint_last_musicbert_small.pt', save_dir='checkpoints', save_interval=1, save_interval_updates=0, scoring='bleu', seed=7, sentence_avg=False, separator_token=2, shard_id=0, shorten_method='truncate', skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, spectral_norm_classification_head=False, spectral_norm_regression_head=False, stop_min_lr=-1.0, stop_time_hours=0, task='xai', tensorboard_logdir='checkpoints/board_apex_M2P_1e-5_small_tmp', threshold_loss_scale=None, tokenizer=None, total_num_update='7000', tpu=False, train_subset='train', unk=3, untie_weights_roberta=False, update_freq=[8], use_bmuf=False, use_old_adam=False, user_dir='musicbert', valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, wandb_project=None, warmup_updates=300, weight_decay=0.01, zero_sharding='none'), 'criterion': Namespace(_name='M2P_xai', activation_dropout=0.0, activation_fn='gelu', adam_betas='(0.9, 0.98)', adam_eps=1e-06, adv=False, all_gather_list_size=16384, arch='musicbert_small', attention_dropout=0.1, azureml_logging=False, batch_size=4, batch_size_valid=4, best_checkpoint_metric='accuracy', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='_xai_apex_M2P_1e-5_small_tmp.pt', classification_head_name='xai_head', clip_norm=0.0, cpu=False, criterion='M2P_xai', curriculum=0, data='processed/xai_data_bin_apex_reg_cls_augmented/0', data_buffer_size=10, dataset_impl=None, ddp_backend='c10d', device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=1, distributed_wrapper='DDP', dropout=0.1, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layerdrop=0, encoder_layers=4, encoder_layers_to_keep=None, end_learning_rate=0.0, eos=2, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, force_anneal=None, fp16=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, gen_subset='test', heartbeat_timeout=-1, init_token=0, keep_best_checkpoints=-1, keep_interval_updates=-1, keep_last_epochs=-1, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_format='json', log_interval=100, lr=[1e-05], lr_scheduler='polynomial_decay', max_epoch=0, max_positions=8192, max_tokens=32768, max_tokens_valid=32768, max_update=7000, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, model_parallel_size=1, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_save=False, no_save_optimizer_state=False, no_seed_provided=False, no_shuffle=False, nprocs_per_node=1, num_cls_classes=13, num_reg_classes=-1, num_shards=1, num_workers=0, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, pooler_activation_fn='tanh', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, regression_target=False, required_batch_size_multiple=1, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=True, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, restore_file='checkpoints/checkpoint_last_musicbert_small.pt', save_dir='checkpoints', save_interval=1, save_interval_updates=0, scoring='bleu', seed=7, sentence_avg=False, separator_token=2, shard_id=0, shorten_method='truncate', skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, spectral_norm_classification_head=False, spectral_norm_regression_head=False, stop_min_lr=-1.0, stop_time_hours=0, task='xai', tensorboard_logdir='checkpoints/board_apex_M2P_1e-5_small_tmp', threshold_loss_scale=None, tokenizer=None, total_num_update='7000', tpu=False, train_subset='train', unk=3, untie_weights_roberta=False, update_freq=[8], use_bmuf=False, use_old_adam=False, user_dir='musicbert', valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, wandb_project=None, warmup_updates=300, weight_decay=0.01, zero_sharding='none'), 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9, 0.98)', 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'tpu': False, 'lr': [1e-05]}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 300, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 7000.0, 'lr': [1e-05]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None}
2022-12-12 19:22:43 | INFO | musicbert | [input] dictionary: 1237 types
2022-12-12 19:22:43 | INFO | musicbert | [label] dictionary: 497 types
2022-12-12 19:22:43 | INFO | fairseq.data.data_utils | loaded 8,870 examples from: processed/xai_data_bin_apex_reg_cls_augmented/0/input0/valid
dataset: 8870
labels: 8870
2022-12-12 19:22:43 | INFO | fairseq_cli.train | MusicBERTModel(
  (encoder): MusicBERTEncoder(
    (sentence_encoder): OctupleEncoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(1237, 512, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(8194, 512, padding_idx=1)
      (emb_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0): TransformerSentenceEncoderLayer(
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        )
        (1): TransformerSentenceEncoderLayer(
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        )
        (2): TransformerSentenceEncoderLayer(
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        )
        (3): TransformerSentenceEncoderLayer(
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        )
      )
      (downsampling): Sequential(
        (0): Linear(in_features=4096, out_features=512, bias=True)
      )
      (upsampling): Sequential(
        (0): Linear(in_features=512, out_features=4096, bias=True)
      )
    )
    (lm_head): RobertaLMHead(
      (dense): Linear(in_features=512, out_features=512, bias=True)
      (layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    )
  )
  (classification_heads): ModuleDict(
    (xai_head): RobertaClassificationHead(
      (dense): Linear(in_features=512, out_features=512, bias=True)
      (dropout): Dropout(p=0.0, inplace=False)
      (out_proj): Linear(in_features=512, out_features=13, bias=True)
    )
  )
  (regression_heads): ModuleDict()
)
2022-12-12 19:22:43 | INFO | fairseq_cli.train | task: MusicBERTSentencePredictionMultilabelTaskXAI
2022-12-12 19:22:43 | INFO | fairseq_cli.train | model: MusicBERTModel
2022-12-12 19:22:43 | INFO | fairseq_cli.train | criterion: MusicBERTM2PCriterionForXAI
2022-12-12 19:22:43 | INFO | fairseq_cli.train | num. model params: 22,805,730 (num. trained: 22,805,730)
2022-12-12 19:22:44 | INFO | fairseq.utils | ***********************CUDA enviroments for all 1 workers***********************
2022-12-12 19:22:44 | INFO | fairseq.utils | rank   0: capabilities =  6.1  ; total memory = 7.927 GB ; name = NVIDIA GeForce GTX 1080                 
2022-12-12 19:22:44 | INFO | fairseq.utils | ***********************CUDA enviroments for all 1 workers***********************
2022-12-12 19:22:44 | INFO | fairseq_cli.train | training on 1 devices (GPUs/TPUs)
2022-12-12 19:22:44 | INFO | fairseq_cli.train | max tokens per GPU = 32768 and batch size per GPU = 4
2022-12-12 19:22:44 | INFO | fairseq.trainer | Preparing to load checkpoint checkpoints/checkpoint_last_musicbert_small.pt
2022-12-12 19:22:44 | INFO | fairseq.trainer | No existing checkpoint found checkpoints/checkpoint_last_musicbert_small.pt
2022-12-12 19:22:44 | INFO | fairseq.trainer | loading train data for epoch 1
2022-12-12 19:22:44 | INFO | fairseq.data.data_utils | loaded 79,823 examples from: processed/xai_data_bin_apex_reg_cls_augmented/0/input0/train
dataset: 79823
labels: 79823
2022-12-12 19:22:46 | INFO | fairseq.trainer | begin training epoch 1
2022-12-12 19:22:59 | INFO | train_inner | {"epoch": 1, "update": 0.04, "loss": "3.683", "nll_loss": "0.144", "accuracy": "8.2", "wps": "6054", "ups": "7.42", "wpb": "816.1", "bsz": "32", "num_updates": "100", "lr": "3.33333e-06", "gnorm": "3.333", "train_wall": "14", "wall": "15"}
2022-12-12 19:23:13 | INFO | train_inner | {"epoch": 1, "update": 0.08, "loss": "3.596", "nll_loss": "0.141", "accuracy": "15.4", "wps": "6132.6", "ups": "7.53", "wpb": "814.5", "bsz": "32", "num_updates": "200", "lr": "6.66667e-06", "gnorm": "3.152", "train_wall": "13", "wall": "28"}
2022-12-12 19:23:27 | INFO | train_inner | {"epoch": 1, "update": 0.12, "loss": "3.221", "nll_loss": "0.126", "accuracy": "25.3", "wps": "5868", "ups": "7.19", "wpb": "816.1", "bsz": "32", "num_updates": "300", "lr": "1e-05", "gnorm": "3.286", "train_wall": "14", "wall": "42"}
2022-12-12 19:23:40 | INFO | train_inner | {"epoch": 1, "update": 0.16, "loss": "3.022", "nll_loss": "0.118", "accuracy": "23.6", "wps": "6180.1", "ups": "7.57", "wpb": "816.8", "bsz": "32", "num_updates": "400", "lr": "9.85075e-06", "gnorm": "2.991", "train_wall": "13", "wall": "56"}
2022-12-12 19:23:53 | INFO | train_inner | {"epoch": 1, "update": 0.2, "loss": "2.937", "nll_loss": "0.115", "accuracy": "23.8", "wps": "6082", "ups": "7.45", "wpb": "816.8", "bsz": "32", "num_updates": "500", "lr": "9.70149e-06", "gnorm": "3.013", "train_wall": "13", "wall": "69"}
2022-12-12 19:24:07 | INFO | train_inner | {"epoch": 1, "update": 0.24, "loss": "2.87", "nll_loss": "0.112", "accuracy": "24.7", "wps": "5830.4", "ups": "7.14", "wpb": "816.6", "bsz": "32", "num_updates": "600", "lr": "9.55224e-06", "gnorm": "2.83", "train_wall": "14", "wall": "83"}
2022-12-12 19:24:22 | INFO | train_inner | {"epoch": 1, "update": 0.281, "loss": "2.836", "nll_loss": "0.111", "accuracy": "26.2", "wps": "5701.2", "ups": "7", "wpb": "814.5", "bsz": "32", "num_updates": "700", "lr": "9.40299e-06", "gnorm": "2.779", "train_wall": "14", "wall": "97"}
2022-12-12 19:24:36 | INFO | train_inner | {"epoch": 1, "update": 0.321, "loss": "2.848", "nll_loss": "0.112", "accuracy": "26.1", "wps": "5799.1", "ups": "7.11", "wpb": "815.5", "bsz": "32", "num_updates": "800", "lr": "9.25373e-06", "gnorm": "2.88", "train_wall": "14", "wall": "111"}
2022-12-12 19:24:50 | INFO | train_inner | {"epoch": 1, "update": 0.361, "loss": "2.89", "nll_loss": "0.113", "accuracy": "25.3", "wps": "5916.9", "ups": "7.26", "wpb": "815.1", "bsz": "32", "num_updates": "900", "lr": "9.10448e-06", "gnorm": "2.887", "train_wall": "14", "wall": "125"}
2022-12-12 19:25:03 | INFO | train_inner | {"epoch": 1, "update": 0.401, "loss": "2.919", "nll_loss": "0.114", "accuracy": "23", "wps": "5897.4", "ups": "7.22", "wpb": "816.6", "bsz": "32", "num_updates": "1000", "lr": "8.95522e-06", "gnorm": "3.077", "train_wall": "14", "wall": "139"}
2022-12-12 19:25:17 | INFO | train_inner | {"epoch": 1, "update": 0.441, "loss": "2.866", "nll_loss": "0.112", "accuracy": "26", "wps": "5962.4", "ups": "7.3", "wpb": "816.3", "bsz": "32", "num_updates": "1100", "lr": "8.80597e-06", "gnorm": "3.15", "train_wall": "14", "wall": "153"}
2022-12-12 19:25:31 | INFO | train_inner | {"epoch": 1, "update": 0.481, "loss": "2.88", "nll_loss": "0.113", "accuracy": "25.3", "wps": "5966.8", "ups": "7.31", "wpb": "816.3", "bsz": "32", "num_updates": "1200", "lr": "8.65672e-06", "gnorm": "3.286", "train_wall": "14", "wall": "167"}
2022-12-12 19:25:45 | INFO | train_inner | {"epoch": 1, "update": 0.521, "loss": "2.828", "nll_loss": "0.111", "accuracy": "27.2", "wps": "5978", "ups": "7.33", "wpb": "815.1", "bsz": "32", "num_updates": "1300", "lr": "8.50746e-06", "gnorm": "3.299", "train_wall": "13", "wall": "180"}
2022-12-12 19:25:58 | INFO | train_inner | {"epoch": 1, "update": 0.561, "loss": "2.798", "nll_loss": "0.11", "accuracy": "26.8", "wps": "5973", "ups": "7.32", "wpb": "816.1", "bsz": "32", "num_updates": "1400", "lr": "8.35821e-06", "gnorm": "3.623", "train_wall": "14", "wall": "194"}
2022-12-12 19:26:12 | INFO | train_inner | {"epoch": 1, "update": 0.601, "loss": "2.803", "nll_loss": "0.11", "accuracy": "27.1", "wps": "6020.7", "ups": "7.37", "wpb": "816.6", "bsz": "32", "num_updates": "1500", "lr": "8.20896e-06", "gnorm": "3.759", "train_wall": "13", "wall": "208"}
2022-12-12 19:26:25 | INFO | train_inner | {"epoch": 1, "update": 0.641, "loss": "2.817", "nll_loss": "0.11", "accuracy": "27", "wps": "6064", "ups": "7.42", "wpb": "817.2", "bsz": "32", "num_updates": "1600", "lr": "8.0597e-06", "gnorm": "4.057", "train_wall": "13", "wall": "221"}
2022-12-12 19:26:39 | INFO | train_inner | {"epoch": 1, "update": 0.681, "loss": "2.821", "nll_loss": "0.111", "accuracy": "26.9", "wps": "5860.5", "ups": "7.19", "wpb": "815.5", "bsz": "32", "num_updates": "1700", "lr": "7.91045e-06", "gnorm": "4.774", "train_wall": "14", "wall": "235"}
2022-12-12 19:26:53 | INFO | train_inner | {"epoch": 1, "update": 0.721, "loss": "2.808", "nll_loss": "0.11", "accuracy": "27.5", "wps": "5853.7", "ups": "7.17", "wpb": "816.5", "bsz": "32", "num_updates": "1800", "lr": "7.76119e-06", "gnorm": "5.083", "train_wall": "14", "wall": "249"}
2022-12-12 19:27:07 | INFO | train_inner | {"epoch": 1, "update": 0.762, "loss": "2.825", "nll_loss": "0.111", "accuracy": "27.6", "wps": "5938.9", "ups": "7.28", "wpb": "816", "bsz": "32", "num_updates": "1900", "lr": "7.61194e-06", "gnorm": "4.902", "train_wall": "14", "wall": "263"}
2022-12-12 19:27:21 | INFO | train_inner | {"epoch": 1, "update": 0.802, "loss": "2.755", "nll_loss": "0.108", "accuracy": "28.5", "wps": "5802.3", "ups": "7.11", "wpb": "816.4", "bsz": "32", "num_updates": "2000", "lr": "7.46269e-06", "gnorm": "5.23", "train_wall": "14", "wall": "277"}
2022-12-12 19:27:35 | INFO | train_inner | {"epoch": 1, "update": 0.842, "loss": "2.735", "nll_loss": "0.107", "accuracy": "29.6", "wps": "5983.2", "ups": "7.32", "wpb": "816.8", "bsz": "32", "num_updates": "2100", "lr": "7.31343e-06", "gnorm": "5.639", "train_wall": "14", "wall": "291"}
2022-12-12 19:27:49 | INFO | train_inner | {"epoch": 1, "update": 0.882, "loss": "2.767", "nll_loss": "0.109", "accuracy": "29", "wps": "5964.5", "ups": "7.31", "wpb": "815.8", "bsz": "32", "num_updates": "2200", "lr": "7.16418e-06", "gnorm": "6.48", "train_wall": "14", "wall": "304"}
2022-12-12 19:28:02 | INFO | train_inner | {"epoch": 1, "update": 0.922, "loss": "2.723", "nll_loss": "0.107", "accuracy": "30.2", "wps": "5919", "ups": "7.26", "wpb": "815.8", "bsz": "32", "num_updates": "2300", "lr": "7.01493e-06", "gnorm": "6.546", "train_wall": "14", "wall": "318"}
2022-12-12 19:28:16 | INFO | train_inner | {"epoch": 1, "update": 0.962, "loss": "2.765", "nll_loss": "0.108", "accuracy": "30", "wps": "5947.2", "ups": "7.29", "wpb": "815.6", "bsz": "32", "num_updates": "2400", "lr": "6.86567e-06", "gnorm": "7.226", "train_wall": "14", "wall": "332"}
2022-12-12 19:28:29 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-12-12 19:28:42 | INFO | valid | {"epoch": 1, "valid_loss": "2.697", "valid_nll_loss": "0.106", "valid_accuracy": "31.2", "valid_wps": "18094.4", "valid_wpb": "102.1", "valid_bsz": "4", "valid_num_updates": "2495"}
2022-12-12 19:28:42 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 1 @ 2495 updates
2022-12-12 19:28:45 | INFO | fairseq.trainer | Finished saving checkpoint to checkpoints/checkpoint_best_xai_apex_M2P_1e-5_small_tmp.pt.pt
2022-12-12 19:28:50 | INFO | fairseq.checkpoint_utils | Saved checkpoint checkpoints/checkpoint_best_xai_apex_M2P_1e-5_small_tmp.pt.pt (epoch 1 @ 2495 updates, score 31.2) (writing took 8.524861440993845 seconds)
2022-12-12 19:28:50 | INFO | fairseq_cli.train | end of epoch 1 (average epoch stats below)
2022-12-12 19:28:50 | INFO | train | {"epoch": 1, "train_loss": "2.91", "train_nll_loss": "0.114", "train_accuracy": "25.6", "train_wps": "5587.9", "train_ups": "6.85", "train_wpb": "815.9", "train_bsz": "32", "train_num_updates": "2495", "train_lr": "6.72388e-06", "train_gnorm": "4.183", "train_train_wall": "339", "train_wall": "366"}
2022-12-12 19:28:50 | INFO | fairseq.trainer | begin training epoch 2
2022-12-12 19:28:51 | INFO | train_inner | {"epoch": 2, "update": 1.002, "loss": "2.715", "nll_loss": "0.106", "accuracy": "30.9", "wps": "2333.9", "ups": "2.87", "wpb": "811.9", "bsz": "31.8", "num_updates": "2500", "lr": "6.71642e-06", "gnorm": "7.547", "train_wall": "13", "wall": "367"}
2022-12-12 19:29:05 | INFO | train_inner | {"epoch": 2, "update": 1.042, "loss": "2.729", "nll_loss": "0.107", "accuracy": "31.2", "wps": "5881.2", "ups": "7.21", "wpb": "816.2", "bsz": "32", "num_updates": "2600", "lr": "6.56716e-06", "gnorm": "8.603", "train_wall": "14", "wall": "381"}
2022-12-12 19:29:18 | INFO | train_inner | {"epoch": 2, "update": 1.082, "loss": "2.642", "nll_loss": "0.104", "accuracy": "33.3", "wps": "6051.6", "ups": "7.41", "wpb": "816.3", "bsz": "32", "num_updates": "2700", "lr": "6.41791e-06", "gnorm": "8.238", "train_wall": "13", "wall": "394"}
2022-12-12 19:29:33 | INFO | train_inner | {"epoch": 2, "update": 1.122, "loss": "2.716", "nll_loss": "0.107", "accuracy": "31.2", "wps": "5748.4", "ups": "7.06", "wpb": "814.7", "bsz": "32", "num_updates": "2800", "lr": "6.26866e-06", "gnorm": "9.209", "train_wall": "14", "wall": "408"}
2022-12-12 19:29:47 | INFO | train_inner | {"epoch": 2, "update": 1.162, "loss": "2.617", "nll_loss": "0.103", "accuracy": "33.4", "wps": "5864.7", "ups": "7.18", "wpb": "816.7", "bsz": "32", "num_updates": "2900", "lr": "6.1194e-06", "gnorm": "8.283", "train_wall": "14", "wall": "422"}
2022-12-12 19:30:00 | INFO | train_inner | {"epoch": 2, "update": 1.202, "loss": "2.68", "nll_loss": "0.105", "accuracy": "31", "wps": "6056.7", "ups": "7.44", "wpb": "814.6", "bsz": "32", "num_updates": "3000", "lr": "5.97015e-06", "gnorm": "9.018", "train_wall": "13", "wall": "436"}
2022-12-12 19:30:14 | INFO | train_inner | {"epoch": 2, "update": 1.242, "loss": "2.613", "nll_loss": "0.103", "accuracy": "34.3", "wps": "6008.9", "ups": "7.38", "wpb": "814.7", "bsz": "32", "num_updates": "3100", "lr": "5.8209e-06", "gnorm": "9.507", "train_wall": "13", "wall": "449"}
2022-12-12 19:30:27 | INFO | train_inner | {"epoch": 2, "update": 1.283, "loss": "2.626", "nll_loss": "0.103", "accuracy": "33.9", "wps": "5977.4", "ups": "7.33", "wpb": "814.9", "bsz": "32", "num_updates": "3200", "lr": "5.67164e-06", "gnorm": "9.146", "train_wall": "13", "wall": "463"}
2022-12-12 19:30:41 | INFO | train_inner | {"epoch": 2, "update": 1.323, "loss": "2.619", "nll_loss": "0.103", "accuracy": "33.3", "wps": "5843.8", "ups": "7.17", "wpb": "815.5", "bsz": "32", "num_updates": "3300", "lr": "5.52239e-06", "gnorm": "9.279", "train_wall": "14", "wall": "477"}
2022-12-12 19:30:55 | INFO | train_inner | {"epoch": 2, "update": 1.363, "loss": "2.635", "nll_loss": "0.103", "accuracy": "31.9", "wps": "5990.3", "ups": "7.35", "wpb": "815.4", "bsz": "32", "num_updates": "3400", "lr": "5.37313e-06", "gnorm": "10.007", "train_wall": "13", "wall": "491"}
2022-12-12 19:31:09 | INFO | train_inner | {"epoch": 2, "update": 1.403, "loss": "2.532", "nll_loss": "0.099", "accuracy": "36.3", "wps": "5891.3", "ups": "7.22", "wpb": "815.5", "bsz": "32", "num_updates": "3500", "lr": "5.22388e-06", "gnorm": "10.356", "train_wall": "14", "wall": "505"}
2022-12-12 19:31:22 | INFO | train_inner | {"epoch": 2, "update": 1.443, "loss": "2.574", "nll_loss": "0.101", "accuracy": "35.8", "wps": "6009.5", "ups": "7.36", "wpb": "816.1", "bsz": "32", "num_updates": "3600", "lr": "5.07463e-06", "gnorm": "11.162", "train_wall": "13", "wall": "518"}
2022-12-12 19:31:36 | INFO | train_inner | {"epoch": 2, "update": 1.483, "loss": "2.601", "nll_loss": "0.102", "accuracy": "33.7", "wps": "6015.1", "ups": "7.37", "wpb": "816.4", "bsz": "32", "num_updates": "3700", "lr": "4.92537e-06", "gnorm": "9.705", "train_wall": "13", "wall": "532"}
2022-12-12 19:31:50 | INFO | train_inner | {"epoch": 2, "update": 1.523, "loss": "2.602", "nll_loss": "0.102", "accuracy": "33.8", "wps": "5875.2", "ups": "7.2", "wpb": "816.4", "bsz": "32", "num_updates": "3800", "lr": "4.77612e-06", "gnorm": "11.942", "train_wall": "14", "wall": "546"}
2022-12-12 19:32:03 | INFO | train_inner | {"epoch": 2, "update": 1.563, "loss": "2.532", "nll_loss": "0.099", "accuracy": "36.6", "wps": "6069.4", "ups": "7.43", "wpb": "816.6", "bsz": "32", "num_updates": "3900", "lr": "4.62687e-06", "gnorm": "9.956", "train_wall": "13", "wall": "559"}
2022-12-12 19:32:17 | INFO | train_inner | {"epoch": 2, "update": 1.603, "loss": "2.565", "nll_loss": "0.101", "accuracy": "35.6", "wps": "6070.2", "ups": "7.44", "wpb": "815.7", "bsz": "32", "num_updates": "4000", "lr": "4.47761e-06", "gnorm": "10.254", "train_wall": "13", "wall": "573"}
2022-12-12 19:32:31 | INFO | train_inner | {"epoch": 2, "update": 1.643, "loss": "2.56", "nll_loss": "0.1", "accuracy": "35.4", "wps": "5976.1", "ups": "7.32", "wpb": "816.7", "bsz": "32", "num_updates": "4100", "lr": "4.32836e-06", "gnorm": "10.493", "train_wall": "14", "wall": "586"}
2022-12-12 19:32:44 | INFO | train_inner | {"epoch": 2, "update": 1.683, "loss": "2.559", "nll_loss": "0.1", "accuracy": "35.9", "wps": "5928.6", "ups": "7.27", "wpb": "815", "bsz": "32", "num_updates": "4200", "lr": "4.1791e-06", "gnorm": "11.351", "train_wall": "14", "wall": "600"}
2022-12-12 19:32:58 | INFO | train_inner | {"epoch": 2, "update": 1.723, "loss": "2.514", "nll_loss": "0.098", "accuracy": "38", "wps": "6056.5", "ups": "7.41", "wpb": "817.2", "bsz": "32", "num_updates": "4300", "lr": "4.02985e-06", "gnorm": "10.463", "train_wall": "13", "wall": "614"}
2022-12-12 19:33:12 | INFO | train_inner | {"epoch": 2, "update": 1.764, "loss": "2.546", "nll_loss": "0.1", "accuracy": "36", "wps": "5974.7", "ups": "7.32", "wpb": "816.5", "bsz": "32", "num_updates": "4400", "lr": "3.8806e-06", "gnorm": "10.052", "train_wall": "14", "wall": "627"}
2022-12-12 19:33:26 | INFO | train_inner | {"epoch": 2, "update": 1.804, "loss": "2.498", "nll_loss": "0.098", "accuracy": "36.6", "wps": "5711.8", "ups": "7", "wpb": "815.8", "bsz": "32", "num_updates": "4500", "lr": "3.73134e-06", "gnorm": "11.158", "train_wall": "14", "wall": "642"}
2022-12-12 19:33:40 | INFO | train_inner | {"epoch": 2, "update": 1.844, "loss": "2.498", "nll_loss": "0.098", "accuracy": "37.7", "wps": "5933.9", "ups": "7.26", "wpb": "817.1", "bsz": "32", "num_updates": "4600", "lr": "3.58209e-06", "gnorm": "11.209", "train_wall": "14", "wall": "655"}
2022-12-12 19:33:54 | INFO | train_inner | {"epoch": 2, "update": 1.884, "loss": "2.513", "nll_loss": "0.099", "accuracy": "37.3", "wps": "5794.4", "ups": "7.11", "wpb": "815.1", "bsz": "32", "num_updates": "4700", "lr": "3.43284e-06", "gnorm": "11.89", "train_wall": "14", "wall": "670"}
2022-12-12 19:34:08 | INFO | train_inner | {"epoch": 2, "update": 1.924, "loss": "2.48", "nll_loss": "0.097", "accuracy": "38.5", "wps": "5995.7", "ups": "7.34", "wpb": "817.3", "bsz": "32", "num_updates": "4800", "lr": "3.28358e-06", "gnorm": "11.291", "train_wall": "13", "wall": "683"}
2022-12-12 19:34:21 | INFO | train_inner | {"epoch": 2, "update": 1.964, "loss": "2.486", "nll_loss": "0.097", "accuracy": "37.1", "wps": "6011.7", "ups": "7.36", "wpb": "817.4", "bsz": "32", "num_updates": "4900", "lr": "3.13433e-06", "gnorm": "11.678", "train_wall": "13", "wall": "697"}
2022-12-12 19:34:34 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-12-12 19:34:46 | INFO | valid | {"epoch": 2, "valid_loss": "2.437", "valid_nll_loss": "0.096", "valid_accuracy": "39", "valid_wps": "18079.8", "valid_wpb": "102.1", "valid_bsz": "4", "valid_num_updates": "4990", "valid_best_accuracy": "39"}
2022-12-12 19:34:46 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 4990 updates
2022-12-12 19:34:49 | INFO | fairseq.trainer | Finished saving checkpoint to checkpoints/checkpoint_best_xai_apex_M2P_1e-5_small_tmp.pt.pt
2022-12-12 19:34:54 | INFO | fairseq.checkpoint_utils | Saved checkpoint checkpoints/checkpoint_best_xai_apex_M2P_1e-5_small_tmp.pt.pt (epoch 2 @ 4990 updates, score 39.0) (writing took 8.41399359004572 seconds)
2022-12-12 19:34:54 | INFO | fairseq_cli.train | end of epoch 2 (average epoch stats below)
2022-12-12 19:34:55 | INFO | train | {"epoch": 2, "train_loss": "2.576", "train_nll_loss": "0.101", "train_accuracy": "35.1", "train_wps": "5587.2", "train_ups": "6.85", "train_wpb": "815.9", "train_bsz": "32", "train_num_updates": "4990", "train_lr": "3e-06", "train_gnorm": "10.194", "train_train_wall": "339", "train_wall": "730"}
2022-12-12 19:34:55 | INFO | fairseq.trainer | begin training epoch 3
2022-12-12 19:34:57 | INFO | train_inner | {"epoch": 3, "update": 2.004, "loss": "2.456", "nll_loss": "0.096", "accuracy": "39.1", "wps": "2283.6", "ups": "2.81", "wpb": "812.4", "bsz": "31.8", "num_updates": "5000", "lr": "2.98507e-06", "gnorm": "10.575", "train_wall": "14", "wall": "732"}
2022-12-12 19:35:10 | INFO | train_inner | {"epoch": 3, "update": 2.044, "loss": "2.457", "nll_loss": "0.096", "accuracy": "39.4", "wps": "5979.8", "ups": "7.32", "wpb": "816.4", "bsz": "32", "num_updates": "5100", "lr": "2.83582e-06", "gnorm": "12.93", "train_wall": "14", "wall": "746"}
2022-12-12 19:35:24 | INFO | train_inner | {"epoch": 3, "update": 2.084, "loss": "2.428", "nll_loss": "0.095", "accuracy": "39.6", "wps": "5909.4", "ups": "7.23", "wpb": "817.3", "bsz": "32", "num_updates": "5200", "lr": "2.68657e-06", "gnorm": "11.876", "train_wall": "14", "wall": "760"}
2022-12-12 19:35:38 | INFO | train_inner | {"epoch": 3, "update": 2.124, "loss": "2.43", "nll_loss": "0.095", "accuracy": "38.8", "wps": "5820.1", "ups": "7.14", "wpb": "815.4", "bsz": "32", "num_updates": "5300", "lr": "2.53731e-06", "gnorm": "11.768", "train_wall": "14", "wall": "774"}
2022-12-12 19:35:52 | INFO | train_inner | {"epoch": 3, "update": 2.164, "loss": "2.403", "nll_loss": "0.094", "accuracy": "39.6", "wps": "6059.9", "ups": "7.42", "wpb": "816.2", "bsz": "32", "num_updates": "5400", "lr": "2.38806e-06", "gnorm": "11.99", "train_wall": "13", "wall": "788"}
2022-12-12 19:36:05 | INFO | train_inner | {"epoch": 3, "update": 2.204, "loss": "2.435", "nll_loss": "0.096", "accuracy": "40.2", "wps": "6042.3", "ups": "7.41", "wpb": "815.8", "bsz": "32", "num_updates": "5500", "lr": "2.23881e-06", "gnorm": "12.434", "train_wall": "13", "wall": "801"}
2022-12-12 19:36:19 | INFO | train_inner | {"epoch": 3, "update": 2.244, "loss": "2.402", "nll_loss": "0.094", "accuracy": "41", "wps": "5821.5", "ups": "7.14", "wpb": "815.8", "bsz": "32", "num_updates": "5600", "lr": "2.08955e-06", "gnorm": "12.314", "train_wall": "14", "wall": "815"}
2022-12-12 19:36:33 | INFO | train_inner | {"epoch": 3, "update": 2.285, "loss": "2.364", "nll_loss": "0.093", "accuracy": "41.4", "wps": "5881.3", "ups": "7.22", "wpb": "815", "bsz": "32", "num_updates": "5700", "lr": "1.9403e-06", "gnorm": "12.471", "train_wall": "14", "wall": "829"}
2022-12-12 19:36:47 | INFO | train_inner | {"epoch": 3, "update": 2.325, "loss": "2.38", "nll_loss": "0.093", "accuracy": "42.5", "wps": "5894.3", "ups": "7.22", "wpb": "816.6", "bsz": "32", "num_updates": "5800", "lr": "1.79104e-06", "gnorm": "14.174", "train_wall": "14", "wall": "843"}
2022-12-12 19:37:01 | INFO | train_inner | {"epoch": 3, "update": 2.365, "loss": "2.384", "nll_loss": "0.094", "accuracy": "40.8", "wps": "5786", "ups": "7.1", "wpb": "815.5", "bsz": "32", "num_updates": "5900", "lr": "1.64179e-06", "gnorm": "11.433", "train_wall": "14", "wall": "857"}
2022-12-12 19:37:15 | INFO | train_inner | {"epoch": 3, "update": 2.405, "loss": "2.392", "nll_loss": "0.094", "accuracy": "40.3", "wps": "6010.3", "ups": "7.37", "wpb": "815.1", "bsz": "32", "num_updates": "6000", "lr": "1.49254e-06", "gnorm": "13.254", "train_wall": "13", "wall": "871"}
2022-12-12 19:37:29 | INFO | train_inner | {"epoch": 3, "update": 2.445, "loss": "2.378", "nll_loss": "0.093", "accuracy": "40.3", "wps": "5676.1", "ups": "6.97", "wpb": "814.8", "bsz": "32", "num_updates": "6100", "lr": "1.34328e-06", "gnorm": "12.286", "train_wall": "14", "wall": "885"}
2022-12-12 19:37:44 | INFO | train_inner | {"epoch": 3, "update": 2.485, "loss": "2.369", "nll_loss": "0.093", "accuracy": "42.5", "wps": "5574.3", "ups": "6.83", "wpb": "815.7", "bsz": "32", "num_updates": "6200", "lr": "1.19403e-06", "gnorm": "12.41", "train_wall": "14", "wall": "900"}
2022-12-12 19:37:58 | INFO | train_inner | {"epoch": 3, "update": 2.525, "loss": "2.295", "nll_loss": "0.09", "accuracy": "43.9", "wps": "5748.4", "ups": "7.04", "wpb": "817", "bsz": "32", "num_updates": "6300", "lr": "1.04478e-06", "gnorm": "12.483", "train_wall": "14", "wall": "914"}
2022-12-12 19:38:12 | INFO | train_inner | {"epoch": 3, "update": 2.565, "loss": "2.367", "nll_loss": "0.093", "accuracy": "41.2", "wps": "5906.7", "ups": "7.23", "wpb": "817", "bsz": "32", "num_updates": "6400", "lr": "8.95522e-07", "gnorm": "12.352", "train_wall": "14", "wall": "928"}
2022-12-12 19:38:26 | INFO | train_inner | {"epoch": 3, "update": 2.605, "loss": "2.327", "nll_loss": "0.091", "accuracy": "42.7", "wps": "6025.3", "ups": "7.38", "wpb": "816.9", "bsz": "32", "num_updates": "6500", "lr": "7.46269e-07", "gnorm": "13.075", "train_wall": "13", "wall": "941"}
2022-12-12 19:38:40 | INFO | train_inner | {"epoch": 3, "update": 2.645, "loss": "2.329", "nll_loss": "0.091", "accuracy": "43.5", "wps": "5807.9", "ups": "7.12", "wpb": "815.7", "bsz": "32", "num_updates": "6600", "lr": "5.97015e-07", "gnorm": "12.784", "train_wall": "14", "wall": "956"}
2022-12-12 19:38:54 | INFO | train_inner | {"epoch": 3, "update": 2.685, "loss": "2.323", "nll_loss": "0.091", "accuracy": "42.5", "wps": "5810.6", "ups": "7.12", "wpb": "816.1", "bsz": "32", "num_updates": "6700", "lr": "4.47761e-07", "gnorm": "12.32", "train_wall": "14", "wall": "970"}
2022-12-12 19:39:08 | INFO | train_inner | {"epoch": 3, "update": 2.725, "loss": "2.376", "nll_loss": "0.093", "accuracy": "41", "wps": "5646.2", "ups": "6.92", "wpb": "815.6", "bsz": "32", "num_updates": "6800", "lr": "2.98507e-07", "gnorm": "12.282", "train_wall": "14", "wall": "984"}
2022-12-12 19:39:23 | INFO | train_inner | {"epoch": 3, "update": 2.766, "loss": "2.34", "nll_loss": "0.092", "accuracy": "42.1", "wps": "5667.9", "ups": "6.94", "wpb": "817", "bsz": "32", "num_updates": "6900", "lr": "1.49254e-07", "gnorm": "13.069", "train_wall": "14", "wall": "999"}
2022-12-12 19:39:37 | INFO | train_inner | {"epoch": 3, "update": 2.806, "loss": "2.292", "nll_loss": "0.09", "accuracy": "43.3", "wps": "5684.3", "ups": "6.97", "wpb": "815.1", "bsz": "32", "num_updates": "7000", "lr": "0", "gnorm": "12.388", "train_wall": "14", "wall": "1013"}
2022-12-12 19:39:37 | INFO | fairseq_cli.train | Stopping training due to num_updates: 7000 >= max_update: 7000
2022-12-12 19:39:37 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-12-12 19:39:50 | INFO | valid | {"epoch": 3, "valid_loss": "2.302", "valid_nll_loss": "0.09", "valid_accuracy": "43.3", "valid_wps": "18005", "valid_wpb": "102.1", "valid_bsz": "4", "valid_num_updates": "7000", "valid_best_accuracy": "43.3"}
2022-12-12 19:39:50 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 3 @ 7000 updates
2022-12-12 19:39:53 | INFO | fairseq.trainer | Finished saving checkpoint to checkpoints/checkpoint_best_xai_apex_M2P_1e-5_small_tmp.pt.pt
2022-12-12 19:39:59 | INFO | fairseq.checkpoint_utils | Saved checkpoint checkpoints/checkpoint_best_xai_apex_M2P_1e-5_small_tmp.pt.pt (epoch 3 @ 7000 updates, score 43.3) (writing took 8.743440764956176 seconds)
2022-12-12 19:39:59 | INFO | fairseq_cli.train | end of epoch 3 (average epoch stats below)
2022-12-12 19:40:00 | INFO | train | {"epoch": 3, "train_loss": "2.374", "train_nll_loss": "0.093", "train_accuracy": "41.3", "train_wps": "5410.3", "train_ups": "6.63", "train_wpb": "816", "train_bsz": "32", "train_num_updates": "7000", "train_lr": "0", "train_gnorm": "12.491", "train_train_wall": "278", "train_wall": "1034"}
2022-12-12 19:40:00 | INFO | fairseq_cli.train | done training in 1034.0 seconds
disable_cp = False
mask_strategy = ['bar']
convert_encoding = OCTMIDI
crop_length = None
2022-12-12 19:40:08 | INFO | fairseq_cli.train | {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': 'json', 'tensorboard_logdir': 'checkpoints/board_apex_M2P_1e-6_small_tmp', 'wandb_project': None, 'azureml_logging': False, 'seed': 7, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': False, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': 'musicbert', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': True}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': True, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'distributed_wrapper': 'DDP', 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'tpu': False, 'distributed_num_procs': 1}, 'dataset': {'_name': None, 'num_workers': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': 32768, 'batch_size': 4, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': 32768, 'batch_size_valid': 4, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 7000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [8], 'lr': [1e-06], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoints/checkpoint_last_musicbert_small.pt', 'finetune_from_model': None, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': True, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'accuracy', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '_xai_apex_M2P_1e-6_small_tmp.pt', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'model_parallel_size': 1, 'distributed_rank': 0}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 1}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='musicbert_small', activation_dropout=0.0, activation_fn='gelu', adam_betas='(0.9, 0.98)', adam_eps=1e-06, adv=False, all_gather_list_size=16384, arch='musicbert_small', attention_dropout=0.1, azureml_logging=False, batch_size=4, batch_size_valid=4, best_checkpoint_metric='accuracy', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='_xai_apex_M2P_1e-6_small_tmp.pt', classification_head_name='xai_head', clip_norm=0.0, cpu=False, criterion='M2P_xai', curriculum=0, data='processed/xai_data_bin_apex_reg_cls_augmented/0', data_buffer_size=10, dataset_impl=None, ddp_backend='c10d', device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=1, distributed_wrapper='DDP', dropout=0.1, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layerdrop=0, encoder_layers=4, encoder_layers_to_keep=None, end_learning_rate=0.0, eos=2, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, force_anneal=None, fp16=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, gen_subset='test', heartbeat_timeout=-1, init_token=0, keep_best_checkpoints=-1, keep_interval_updates=-1, keep_last_epochs=-1, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_format='json', log_interval=100, lr=[1e-06], lr_scheduler='polynomial_decay', max_epoch=0, max_positions=8192, max_tokens=32768, max_tokens_valid=32768, max_update=7000, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, model_parallel_size=1, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_save=False, no_save_optimizer_state=False, no_seed_provided=False, no_shuffle=False, nprocs_per_node=1, num_cls_classes=13, num_reg_classes=-1, num_shards=1, num_workers=0, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, pooler_activation_fn='tanh', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, regression_target=False, required_batch_size_multiple=1, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=True, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, restore_file='checkpoints/checkpoint_last_musicbert_small.pt', save_dir='checkpoints', save_interval=1, save_interval_updates=0, scoring='bleu', seed=7, sentence_avg=False, separator_token=2, shard_id=0, shorten_method='truncate', skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, spectral_norm_classification_head=False, spectral_norm_regression_head=False, stop_min_lr=-1.0, stop_time_hours=0, task='xai', tensorboard_logdir='checkpoints/board_apex_M2P_1e-6_small_tmp', threshold_loss_scale=None, tokenizer=None, total_num_update='7000', tpu=False, train_subset='train', unk=3, untie_weights_roberta=False, update_freq=[8], use_bmuf=False, use_old_adam=False, user_dir='musicbert', valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, wandb_project=None, warmup_updates=300, weight_decay=0.01, zero_sharding='none'), 'task': Namespace(_name='xai', activation_dropout=0.0, activation_fn='gelu', adam_betas='(0.9, 0.98)', adam_eps=1e-06, adv=False, all_gather_list_size=16384, arch='musicbert_small', attention_dropout=0.1, azureml_logging=False, batch_size=4, batch_size_valid=4, best_checkpoint_metric='accuracy', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='_xai_apex_M2P_1e-6_small_tmp.pt', classification_head_name='xai_head', clip_norm=0.0, cpu=False, criterion='M2P_xai', curriculum=0, data='processed/xai_data_bin_apex_reg_cls_augmented/0', data_buffer_size=10, dataset_impl=None, ddp_backend='c10d', device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=1, distributed_wrapper='DDP', dropout=0.1, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layerdrop=0, encoder_layers=4, encoder_layers_to_keep=None, end_learning_rate=0.0, eos=2, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, force_anneal=None, fp16=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, gen_subset='test', heartbeat_timeout=-1, init_token=0, keep_best_checkpoints=-1, keep_interval_updates=-1, keep_last_epochs=-1, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_format='json', log_interval=100, lr=[1e-06], lr_scheduler='polynomial_decay', max_epoch=0, max_positions=8192, max_tokens=32768, max_tokens_valid=32768, max_update=7000, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, model_parallel_size=1, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_save=False, no_save_optimizer_state=False, no_seed_provided=False, no_shuffle=False, nprocs_per_node=1, num_cls_classes=13, num_reg_classes=-1, num_shards=1, num_workers=0, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, pooler_activation_fn='tanh', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, regression_target=False, required_batch_size_multiple=1, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=True, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, restore_file='checkpoints/checkpoint_last_musicbert_small.pt', save_dir='checkpoints', save_interval=1, save_interval_updates=0, scoring='bleu', seed=7, sentence_avg=False, separator_token=2, shard_id=0, shorten_method='truncate', skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, spectral_norm_classification_head=False, spectral_norm_regression_head=False, stop_min_lr=-1.0, stop_time_hours=0, task='xai', tensorboard_logdir='checkpoints/board_apex_M2P_1e-6_small_tmp', threshold_loss_scale=None, tokenizer=None, total_num_update='7000', tpu=False, train_subset='train', unk=3, untie_weights_roberta=False, update_freq=[8], use_bmuf=False, use_old_adam=False, user_dir='musicbert', valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, wandb_project=None, warmup_updates=300, weight_decay=0.01, zero_sharding='none'), 'criterion': Namespace(_name='M2P_xai', activation_dropout=0.0, activation_fn='gelu', adam_betas='(0.9, 0.98)', adam_eps=1e-06, adv=False, all_gather_list_size=16384, arch='musicbert_small', attention_dropout=0.1, azureml_logging=False, batch_size=4, batch_size_valid=4, best_checkpoint_metric='accuracy', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='_xai_apex_M2P_1e-6_small_tmp.pt', classification_head_name='xai_head', clip_norm=0.0, cpu=False, criterion='M2P_xai', curriculum=0, data='processed/xai_data_bin_apex_reg_cls_augmented/0', data_buffer_size=10, dataset_impl=None, ddp_backend='c10d', device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=1, distributed_wrapper='DDP', dropout=0.1, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layerdrop=0, encoder_layers=4, encoder_layers_to_keep=None, end_learning_rate=0.0, eos=2, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, force_anneal=None, fp16=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, gen_subset='test', heartbeat_timeout=-1, init_token=0, keep_best_checkpoints=-1, keep_interval_updates=-1, keep_last_epochs=-1, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_format='json', log_interval=100, lr=[1e-06], lr_scheduler='polynomial_decay', max_epoch=0, max_positions=8192, max_tokens=32768, max_tokens_valid=32768, max_update=7000, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, model_parallel_size=1, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_save=False, no_save_optimizer_state=False, no_seed_provided=False, no_shuffle=False, nprocs_per_node=1, num_cls_classes=13, num_reg_classes=-1, num_shards=1, num_workers=0, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, pooler_activation_fn='tanh', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, regression_target=False, required_batch_size_multiple=1, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=True, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, restore_file='checkpoints/checkpoint_last_musicbert_small.pt', save_dir='checkpoints', save_interval=1, save_interval_updates=0, scoring='bleu', seed=7, sentence_avg=False, separator_token=2, shard_id=0, shorten_method='truncate', skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, spectral_norm_classification_head=False, spectral_norm_regression_head=False, stop_min_lr=-1.0, stop_time_hours=0, task='xai', tensorboard_logdir='checkpoints/board_apex_M2P_1e-6_small_tmp', threshold_loss_scale=None, tokenizer=None, total_num_update='7000', tpu=False, train_subset='train', unk=3, untie_weights_roberta=False, update_freq=[8], use_bmuf=False, use_old_adam=False, user_dir='musicbert', valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, wandb_project=None, warmup_updates=300, weight_decay=0.01, zero_sharding='none'), 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9, 0.98)', 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'tpu': False, 'lr': [1e-06]}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 300, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 7000.0, 'lr': [1e-06]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None}
2022-12-12 19:40:08 | INFO | musicbert | [input] dictionary: 1237 types
2022-12-12 19:40:08 | INFO | musicbert | [label] dictionary: 497 types
2022-12-12 19:40:08 | INFO | fairseq.data.data_utils | loaded 8,870 examples from: processed/xai_data_bin_apex_reg_cls_augmented/0/input0/valid
dataset: 8870
labels: 8870
2022-12-12 19:40:09 | INFO | fairseq_cli.train | MusicBERTModel(
  (encoder): MusicBERTEncoder(
    (sentence_encoder): OctupleEncoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(1237, 512, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(8194, 512, padding_idx=1)
      (emb_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0): TransformerSentenceEncoderLayer(
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        )
        (1): TransformerSentenceEncoderLayer(
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        )
        (2): TransformerSentenceEncoderLayer(
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        )
        (3): TransformerSentenceEncoderLayer(
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        )
      )
      (downsampling): Sequential(
        (0): Linear(in_features=4096, out_features=512, bias=True)
      )
      (upsampling): Sequential(
        (0): Linear(in_features=512, out_features=4096, bias=True)
      )
    )
    (lm_head): RobertaLMHead(
      (dense): Linear(in_features=512, out_features=512, bias=True)
      (layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    )
  )
  (classification_heads): ModuleDict(
    (xai_head): RobertaClassificationHead(
      (dense): Linear(in_features=512, out_features=512, bias=True)
      (dropout): Dropout(p=0.0, inplace=False)
      (out_proj): Linear(in_features=512, out_features=13, bias=True)
    )
  )
  (regression_heads): ModuleDict()
)
2022-12-12 19:40:09 | INFO | fairseq_cli.train | task: MusicBERTSentencePredictionMultilabelTaskXAI
2022-12-12 19:40:09 | INFO | fairseq_cli.train | model: MusicBERTModel
2022-12-12 19:40:09 | INFO | fairseq_cli.train | criterion: MusicBERTM2PCriterionForXAI
2022-12-12 19:40:09 | INFO | fairseq_cli.train | num. model params: 22,805,730 (num. trained: 22,805,730)
2022-12-12 19:40:10 | INFO | fairseq.utils | ***********************CUDA enviroments for all 1 workers***********************
2022-12-12 19:40:10 | INFO | fairseq.utils | rank   0: capabilities =  6.1  ; total memory = 7.927 GB ; name = NVIDIA GeForce GTX 1080                 
2022-12-12 19:40:10 | INFO | fairseq.utils | ***********************CUDA enviroments for all 1 workers***********************
2022-12-12 19:40:10 | INFO | fairseq_cli.train | training on 1 devices (GPUs/TPUs)
2022-12-12 19:40:10 | INFO | fairseq_cli.train | max tokens per GPU = 32768 and batch size per GPU = 4
2022-12-12 19:40:10 | INFO | fairseq.trainer | Preparing to load checkpoint checkpoints/checkpoint_last_musicbert_small.pt
2022-12-12 19:40:10 | INFO | fairseq.trainer | No existing checkpoint found checkpoints/checkpoint_last_musicbert_small.pt
2022-12-12 19:40:10 | INFO | fairseq.trainer | loading train data for epoch 1
2022-12-12 19:40:10 | INFO | fairseq.data.data_utils | loaded 79,823 examples from: processed/xai_data_bin_apex_reg_cls_augmented/0/input0/train
dataset: 79823
labels: 79823
2022-12-12 19:40:11 | INFO | fairseq.trainer | begin training epoch 1
2022-12-12 19:40:25 | INFO | train_inner | {"epoch": 1, "update": 0.04, "loss": "3.711", "nll_loss": "0.146", "accuracy": "7.5", "wps": "6066.4", "ups": "7.43", "wpb": "816.1", "bsz": "32", "num_updates": "100", "lr": "3.33333e-07", "gnorm": "3.394", "train_wall": "14", "wall": "15"}
2022-12-12 19:40:38 | INFO | train_inner | {"epoch": 1, "update": 0.08, "loss": "3.691", "nll_loss": "0.145", "accuracy": "8.8", "wps": "6060.5", "ups": "7.44", "wpb": "814.5", "bsz": "32", "num_updates": "200", "lr": "6.66667e-07", "gnorm": "3.152", "train_wall": "13", "wall": "28"}
2022-12-12 19:40:52 | INFO | train_inner | {"epoch": 1, "update": 0.12, "loss": "3.667", "nll_loss": "0.144", "accuracy": "8.3", "wps": "5867", "ups": "7.19", "wpb": "816.1", "bsz": "32", "num_updates": "300", "lr": "1e-06", "gnorm": "3.203", "train_wall": "14", "wall": "42"}
2022-12-12 19:41:05 | INFO | train_inner | {"epoch": 1, "update": 0.16, "loss": "3.64", "nll_loss": "0.143", "accuracy": "10.5", "wps": "6186.2", "ups": "7.57", "wpb": "816.8", "bsz": "32", "num_updates": "400", "lr": "9.85075e-07", "gnorm": "3.176", "train_wall": "13", "wall": "56"}
2022-12-12 19:41:19 | INFO | train_inner | {"epoch": 1, "update": 0.2, "loss": "3.613", "nll_loss": "0.141", "accuracy": "12.9", "wps": "6075.2", "ups": "7.44", "wpb": "816.8", "bsz": "32", "num_updates": "500", "lr": "9.70149e-07", "gnorm": "3.275", "train_wall": "13", "wall": "69"}
2022-12-12 19:41:33 | INFO | train_inner | {"epoch": 1, "update": 0.24, "loss": "3.579", "nll_loss": "0.14", "accuracy": "22.7", "wps": "5781.5", "ups": "7.08", "wpb": "816.6", "bsz": "32", "num_updates": "600", "lr": "9.55224e-07", "gnorm": "3.205", "train_wall": "14", "wall": "83"}
2022-12-12 19:41:47 | INFO | train_inner | {"epoch": 1, "update": 0.281, "loss": "3.535", "nll_loss": "0.139", "accuracy": "21.7", "wps": "5650.7", "ups": "6.94", "wpb": "814.5", "bsz": "32", "num_updates": "700", "lr": "9.40299e-07", "gnorm": "3.242", "train_wall": "14", "wall": "98"}
2022-12-12 19:42:02 | INFO | train_inner | {"epoch": 1, "update": 0.321, "loss": "3.495", "nll_loss": "0.137", "accuracy": "24.7", "wps": "5786.1", "ups": "7.1", "wpb": "815.5", "bsz": "32", "num_updates": "800", "lr": "9.25373e-07", "gnorm": "3.299", "train_wall": "14", "wall": "112"}
2022-12-12 19:42:15 | INFO | train_inner | {"epoch": 1, "update": 0.361, "loss": "3.452", "nll_loss": "0.136", "accuracy": "22.6", "wps": "5918.3", "ups": "7.26", "wpb": "815.1", "bsz": "32", "num_updates": "900", "lr": "9.10448e-07", "gnorm": "3.327", "train_wall": "14", "wall": "126"}
2022-12-12 19:42:29 | INFO | train_inner | {"epoch": 1, "update": 0.401, "loss": "3.403", "nll_loss": "0.133", "accuracy": "23.3", "wps": "5905.3", "ups": "7.23", "wpb": "816.6", "bsz": "32", "num_updates": "1000", "lr": "8.95522e-07", "gnorm": "3.436", "train_wall": "14", "wall": "140"}
2022-12-12 19:42:43 | INFO | train_inner | {"epoch": 1, "update": 0.441, "loss": "3.315", "nll_loss": "0.13", "accuracy": "24.3", "wps": "5922.6", "ups": "7.26", "wpb": "816.3", "bsz": "32", "num_updates": "1100", "lr": "8.80597e-07", "gnorm": "3.456", "train_wall": "14", "wall": "153"}
2022-12-12 19:42:57 | INFO | train_inner | {"epoch": 1, "update": 0.481, "loss": "3.261", "nll_loss": "0.128", "accuracy": "23.5", "wps": "5936.8", "ups": "7.27", "wpb": "816.3", "bsz": "32", "num_updates": "1200", "lr": "8.65672e-07", "gnorm": "3.47", "train_wall": "14", "wall": "167"}
2022-12-12 19:43:11 | INFO | train_inner | {"epoch": 1, "update": 0.521, "loss": "3.183", "nll_loss": "0.125", "accuracy": "25.7", "wps": "5945.4", "ups": "7.29", "wpb": "815.1", "bsz": "32", "num_updates": "1300", "lr": "8.50746e-07", "gnorm": "3.362", "train_wall": "14", "wall": "181"}
2022-12-12 19:43:24 | INFO | train_inner | {"epoch": 1, "update": 0.561, "loss": "3.124", "nll_loss": "0.123", "accuracy": "25.8", "wps": "5947.2", "ups": "7.29", "wpb": "816.1", "bsz": "32", "num_updates": "1400", "lr": "8.35821e-07", "gnorm": "3.309", "train_wall": "14", "wall": "195"}
2022-12-12 19:43:38 | INFO | train_inner | {"epoch": 1, "update": 0.601, "loss": "3.082", "nll_loss": "0.121", "accuracy": "26", "wps": "5986.7", "ups": "7.33", "wpb": "816.6", "bsz": "32", "num_updates": "1500", "lr": "8.20896e-07", "gnorm": "3.226", "train_wall": "13", "wall": "208"}
2022-12-12 19:43:52 | INFO | train_inner | {"epoch": 1, "update": 0.641, "loss": "3.086", "nll_loss": "0.121", "accuracy": "24.9", "wps": "6047.9", "ups": "7.4", "wpb": "817.2", "bsz": "32", "num_updates": "1600", "lr": "8.0597e-07", "gnorm": "3.275", "train_wall": "13", "wall": "222"}
2022-12-12 19:44:06 | INFO | train_inner | {"epoch": 1, "update": 0.681, "loss": "3.074", "nll_loss": "0.121", "accuracy": "24.9", "wps": "5850.5", "ups": "7.17", "wpb": "815.5", "bsz": "32", "num_updates": "1700", "lr": "7.91045e-07", "gnorm": "3.404", "train_wall": "14", "wall": "236"}
2022-12-12 19:44:20 | INFO | train_inner | {"epoch": 1, "update": 0.721, "loss": "3.057", "nll_loss": "0.12", "accuracy": "23.5", "wps": "5810.1", "ups": "7.12", "wpb": "816.5", "bsz": "32", "num_updates": "1800", "lr": "7.76119e-07", "gnorm": "3.146", "train_wall": "14", "wall": "250"}
2022-12-12 19:44:34 | INFO | train_inner | {"epoch": 1, "update": 0.762, "loss": "3.053", "nll_loss": "0.12", "accuracy": "22.8", "wps": "5865.6", "ups": "7.19", "wpb": "816", "bsz": "32", "num_updates": "1900", "lr": "7.61194e-07", "gnorm": "3.072", "train_wall": "14", "wall": "264"}
2022-12-12 19:44:48 | INFO | train_inner | {"epoch": 1, "update": 0.802, "loss": "2.99", "nll_loss": "0.117", "accuracy": "25.2", "wps": "5761.8", "ups": "7.06", "wpb": "816.4", "bsz": "32", "num_updates": "2000", "lr": "7.46269e-07", "gnorm": "3.048", "train_wall": "14", "wall": "278"}
2022-12-12 19:45:02 | INFO | train_inner | {"epoch": 1, "update": 0.842, "loss": "2.964", "nll_loss": "0.116", "accuracy": "25", "wps": "5935.2", "ups": "7.27", "wpb": "816.8", "bsz": "32", "num_updates": "2100", "lr": "7.31343e-07", "gnorm": "3.091", "train_wall": "14", "wall": "292"}
2022-12-12 19:45:15 | INFO | train_inner | {"epoch": 1, "update": 0.882, "loss": "3.004", "nll_loss": "0.118", "accuracy": "23.4", "wps": "5952.9", "ups": "7.3", "wpb": "815.8", "bsz": "32", "num_updates": "2200", "lr": "7.16418e-07", "gnorm": "2.989", "train_wall": "14", "wall": "306"}
2022-12-12 19:45:29 | INFO | train_inner | {"epoch": 1, "update": 0.922, "loss": "2.951", "nll_loss": "0.116", "accuracy": "25.5", "wps": "5868.8", "ups": "7.19", "wpb": "815.8", "bsz": "32", "num_updates": "2300", "lr": "7.01493e-07", "gnorm": "3.004", "train_wall": "14", "wall": "320"}
2022-12-12 19:45:43 | INFO | train_inner | {"epoch": 1, "update": 0.962, "loss": "2.979", "nll_loss": "0.117", "accuracy": "23.8", "wps": "5899.6", "ups": "7.23", "wpb": "815.6", "bsz": "32", "num_updates": "2400", "lr": "6.86567e-07", "gnorm": "2.934", "train_wall": "14", "wall": "333"}
2022-12-12 19:45:56 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-12-12 19:46:09 | INFO | valid | {"epoch": 1, "valid_loss": "2.935", "valid_nll_loss": "0.115", "valid_accuracy": "25.4", "valid_wps": "18020.6", "valid_wpb": "102.1", "valid_bsz": "4", "valid_num_updates": "2495"}
2022-12-12 19:46:09 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 1 @ 2495 updates
2022-12-12 19:46:12 | INFO | fairseq.trainer | Finished saving checkpoint to checkpoints/checkpoint_best_xai_apex_M2P_1e-6_small_tmp.pt.pt
2022-12-12 19:46:17 | INFO | fairseq.checkpoint_utils | Saved checkpoint checkpoints/checkpoint_best_xai_apex_M2P_1e-6_small_tmp.pt.pt (epoch 1 @ 2495 updates, score 25.4) (writing took 8.534049836918712 seconds)
2022-12-12 19:46:17 | INFO | fairseq_cli.train | end of epoch 1 (average epoch stats below)
2022-12-12 19:46:17 | INFO | train | {"epoch": 1, "train_loss": "3.275", "train_nll_loss": "0.128", "train_accuracy": "21.3", "train_wps": "5561.7", "train_ups": "6.82", "train_wpb": "815.9", "train_bsz": "32", "train_num_updates": "2495", "train_lr": "6.72388e-07", "train_gnorm": "3.22", "train_train_wall": "340", "train_wall": "368"}
2022-12-12 19:46:17 | INFO | fairseq.trainer | begin training epoch 2
2022-12-12 19:46:18 | INFO | train_inner | {"epoch": 2, "update": 1.002, "loss": "2.955", "nll_loss": "0.116", "accuracy": "25.8", "wps": "2323.6", "ups": "2.86", "wpb": "811.9", "bsz": "31.8", "num_updates": "2500", "lr": "6.71642e-07", "gnorm": "3.001", "train_wall": "14", "wall": "368"}
2022-12-12 19:46:32 | INFO | train_inner | {"epoch": 2, "update": 1.042, "loss": "2.966", "nll_loss": "0.116", "accuracy": "23.5", "wps": "5871.4", "ups": "7.19", "wpb": "816.2", "bsz": "32", "num_updates": "2600", "lr": "6.56716e-07", "gnorm": "2.963", "train_wall": "14", "wall": "382"}
2022-12-12 19:46:46 | INFO | train_inner | {"epoch": 2, "update": 1.082, "loss": "2.898", "nll_loss": "0.114", "accuracy": "26.6", "wps": "6052.9", "ups": "7.42", "wpb": "816.3", "bsz": "32", "num_updates": "2700", "lr": "6.41791e-07", "gnorm": "2.945", "train_wall": "13", "wall": "396"}
2022-12-12 19:47:00 | INFO | train_inner | {"epoch": 2, "update": 1.122, "loss": "2.962", "nll_loss": "0.116", "accuracy": "24.5", "wps": "5781.1", "ups": "7.1", "wpb": "814.7", "bsz": "32", "num_updates": "2800", "lr": "6.26866e-07", "gnorm": "3.034", "train_wall": "14", "wall": "410"}
2022-12-12 19:47:14 | INFO | train_inner | {"epoch": 2, "update": 1.162, "loss": "2.887", "nll_loss": "0.113", "accuracy": "26.5", "wps": "5882", "ups": "7.2", "wpb": "816.7", "bsz": "32", "num_updates": "2900", "lr": "6.1194e-07", "gnorm": "2.925", "train_wall": "14", "wall": "424"}
2022-12-12 19:47:27 | INFO | train_inner | {"epoch": 2, "update": 1.202, "loss": "2.935", "nll_loss": "0.115", "accuracy": "23.9", "wps": "6060.5", "ups": "7.44", "wpb": "814.6", "bsz": "32", "num_updates": "3000", "lr": "5.97015e-07", "gnorm": "2.881", "train_wall": "13", "wall": "437"}
2022-12-12 19:47:41 | INFO | train_inner | {"epoch": 2, "update": 1.242, "loss": "2.897", "nll_loss": "0.114", "accuracy": "24.8", "wps": "5985.4", "ups": "7.35", "wpb": "814.7", "bsz": "32", "num_updates": "3100", "lr": "5.8209e-07", "gnorm": "3.002", "train_wall": "13", "wall": "451"}
2022-12-12 19:47:55 | INFO | train_inner | {"epoch": 2, "update": 1.283, "loss": "2.913", "nll_loss": "0.114", "accuracy": "24.8", "wps": "5956.3", "ups": "7.31", "wpb": "814.9", "bsz": "32", "num_updates": "3200", "lr": "5.67164e-07", "gnorm": "2.995", "train_wall": "14", "wall": "465"}
2022-12-12 19:48:09 | INFO | train_inner | {"epoch": 2, "update": 1.323, "loss": "2.92", "nll_loss": "0.115", "accuracy": "25", "wps": "5803.6", "ups": "7.12", "wpb": "815.5", "bsz": "32", "num_updates": "3300", "lr": "5.52239e-07", "gnorm": "2.923", "train_wall": "14", "wall": "479"}
2022-12-12 19:48:22 | INFO | train_inner | {"epoch": 2, "update": 1.363, "loss": "2.931", "nll_loss": "0.115", "accuracy": "24.4", "wps": "5953.2", "ups": "7.3", "wpb": "815.4", "bsz": "32", "num_updates": "3400", "lr": "5.37313e-07", "gnorm": "2.888", "train_wall": "14", "wall": "493"}
2022-12-12 19:48:36 | INFO | train_inner | {"epoch": 2, "update": 1.403, "loss": "2.864", "nll_loss": "0.112", "accuracy": "26.1", "wps": "5847.2", "ups": "7.17", "wpb": "815.5", "bsz": "32", "num_updates": "3500", "lr": "5.22388e-07", "gnorm": "3.083", "train_wall": "14", "wall": "507"}
2022-12-12 19:48:50 | INFO | train_inner | {"epoch": 2, "update": 1.443, "loss": "2.891", "nll_loss": "0.113", "accuracy": "25.5", "wps": "6001.5", "ups": "7.35", "wpb": "816.1", "bsz": "32", "num_updates": "3600", "lr": "5.07463e-07", "gnorm": "3.001", "train_wall": "13", "wall": "520"}
2022-12-12 19:49:04 | INFO | train_inner | {"epoch": 2, "update": 1.483, "loss": "2.923", "nll_loss": "0.115", "accuracy": "24.4", "wps": "5955.6", "ups": "7.3", "wpb": "816.4", "bsz": "32", "num_updates": "3700", "lr": "4.92537e-07", "gnorm": "2.931", "train_wall": "14", "wall": "534"}
2022-12-12 19:49:18 | INFO | train_inner | {"epoch": 2, "update": 1.523, "loss": "2.92", "nll_loss": "0.114", "accuracy": "24.7", "wps": "5830.6", "ups": "7.14", "wpb": "816.4", "bsz": "32", "num_updates": "3800", "lr": "4.77612e-07", "gnorm": "3.103", "train_wall": "14", "wall": "548"}
2022-12-12 19:49:31 | INFO | train_inner | {"epoch": 2, "update": 1.563, "loss": "2.894", "nll_loss": "0.113", "accuracy": "25.3", "wps": "6001.5", "ups": "7.35", "wpb": "816.6", "bsz": "32", "num_updates": "3900", "lr": "4.62687e-07", "gnorm": "2.976", "train_wall": "13", "wall": "562"}
2022-12-12 19:49:45 | INFO | train_inner | {"epoch": 2, "update": 1.603, "loss": "2.92", "nll_loss": "0.115", "accuracy": "24.8", "wps": "6079.7", "ups": "7.45", "wpb": "815.7", "bsz": "32", "num_updates": "4000", "lr": "4.47761e-07", "gnorm": "2.934", "train_wall": "13", "wall": "575"}
2022-12-12 19:49:59 | INFO | train_inner | {"epoch": 2, "update": 1.643, "loss": "2.921", "nll_loss": "0.114", "accuracy": "25.5", "wps": "5959.7", "ups": "7.3", "wpb": "816.7", "bsz": "32", "num_updates": "4100", "lr": "4.32836e-07", "gnorm": "2.962", "train_wall": "14", "wall": "589"}
2022-12-12 19:50:13 | INFO | train_inner | {"epoch": 2, "update": 1.683, "loss": "2.902", "nll_loss": "0.114", "accuracy": "24.2", "wps": "5844.6", "ups": "7.17", "wpb": "815", "bsz": "32", "num_updates": "4200", "lr": "4.1791e-07", "gnorm": "3.061", "train_wall": "14", "wall": "603"}
2022-12-12 19:50:26 | INFO | train_inner | {"epoch": 2, "update": 1.723, "loss": "2.912", "nll_loss": "0.114", "accuracy": "24.7", "wps": "6038.8", "ups": "7.39", "wpb": "817.2", "bsz": "32", "num_updates": "4300", "lr": "4.02985e-07", "gnorm": "2.966", "train_wall": "13", "wall": "616"}
2022-12-12 19:50:40 | INFO | train_inner | {"epoch": 2, "update": 1.764, "loss": "2.904", "nll_loss": "0.114", "accuracy": "24.2", "wps": "6016.4", "ups": "7.37", "wpb": "816.5", "bsz": "32", "num_updates": "4400", "lr": "3.8806e-07", "gnorm": "3.039", "train_wall": "13", "wall": "630"}
2022-12-12 19:50:53 | INFO | train_inner | {"epoch": 2, "update": 1.804, "loss": "2.902", "nll_loss": "0.114", "accuracy": "24.9", "wps": "5946", "ups": "7.29", "wpb": "815.8", "bsz": "32", "num_updates": "4500", "lr": "3.73134e-07", "gnorm": "3.02", "train_wall": "14", "wall": "644"}
2022-12-12 19:51:07 | INFO | train_inner | {"epoch": 2, "update": 1.844, "loss": "2.889", "nll_loss": "0.113", "accuracy": "25.7", "wps": "5917.3", "ups": "7.24", "wpb": "817.1", "bsz": "32", "num_updates": "4600", "lr": "3.58209e-07", "gnorm": "3.039", "train_wall": "14", "wall": "658"}
2022-12-12 19:51:21 | INFO | train_inner | {"epoch": 2, "update": 1.884, "loss": "2.939", "nll_loss": "0.115", "accuracy": "24.2", "wps": "5787.4", "ups": "7.1", "wpb": "815.1", "bsz": "32", "num_updates": "4700", "lr": "3.43284e-07", "gnorm": "2.98", "train_wall": "14", "wall": "672"}
2022-12-12 19:51:35 | INFO | train_inner | {"epoch": 2, "update": 1.924, "loss": "2.907", "nll_loss": "0.114", "accuracy": "24.9", "wps": "6007.3", "ups": "7.35", "wpb": "817.3", "bsz": "32", "num_updates": "4800", "lr": "3.28358e-07", "gnorm": "2.99", "train_wall": "13", "wall": "685"}
2022-12-12 19:51:49 | INFO | train_inner | {"epoch": 2, "update": 1.964, "loss": "2.907", "nll_loss": "0.114", "accuracy": "24.5", "wps": "6009.5", "ups": "7.35", "wpb": "817.4", "bsz": "32", "num_updates": "4900", "lr": "3.13433e-07", "gnorm": "3.068", "train_wall": "13", "wall": "699"}
2022-12-12 19:52:01 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-12-12 19:52:15 | INFO | valid | {"epoch": 2, "valid_loss": "2.894", "valid_nll_loss": "0.113", "valid_accuracy": "24.4", "valid_wps": "16729.7", "valid_wpb": "102.1", "valid_bsz": "4", "valid_num_updates": "4990", "valid_best_accuracy": "25.4"}
2022-12-12 19:52:15 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 4990 updates
2022-12-12 19:52:18 | INFO | fairseq.trainer | Finished saving checkpoint to checkpoints/checkpoint_last_xai_apex_M2P_1e-6_small_tmp.pt.pt
2022-12-12 19:52:18 | INFO | fairseq.checkpoint_utils | Saved checkpoint checkpoints/checkpoint_last_xai_apex_M2P_1e-6_small_tmp.pt.pt (epoch 2 @ 4990 updates, score 24.4) (writing took 3.04591610096395 seconds)
2022-12-12 19:52:18 | INFO | fairseq_cli.train | end of epoch 2 (average epoch stats below)
2022-12-12 19:52:19 | INFO | train | {"epoch": 2, "train_loss": "2.912", "train_nll_loss": "0.114", "train_accuracy": "24.9", "train_wps": "5647.7", "train_ups": "6.92", "train_wpb": "815.9", "train_bsz": "32", "train_num_updates": "4990", "train_lr": "3e-07", "train_gnorm": "2.986", "train_train_wall": "339", "train_wall": "728"}
2022-12-12 19:52:19 | INFO | fairseq.trainer | begin training epoch 3
2022-12-12 19:52:20 | INFO | train_inner | {"epoch": 3, "update": 2.004, "loss": "2.905", "nll_loss": "0.114", "accuracy": "24.5", "wps": "2601.7", "ups": "3.2", "wpb": "812.4", "bsz": "31.8", "num_updates": "5000", "lr": "2.98507e-07", "gnorm": "2.927", "train_wall": "14", "wall": "730"}
2022-12-12 19:52:34 | INFO | train_inner | {"epoch": 3, "update": 2.044, "loss": "2.893", "nll_loss": "0.113", "accuracy": "26.1", "wps": "5984.5", "ups": "7.33", "wpb": "816.4", "bsz": "32", "num_updates": "5100", "lr": "2.83582e-07", "gnorm": "3.104", "train_wall": "13", "wall": "744"}
2022-12-12 19:52:48 | INFO | train_inner | {"epoch": 3, "update": 2.084, "loss": "2.9", "nll_loss": "0.114", "accuracy": "25.5", "wps": "5828.5", "ups": "7.13", "wpb": "817.3", "bsz": "32", "num_updates": "5200", "lr": "2.68657e-07", "gnorm": "3.018", "train_wall": "14", "wall": "758"}
2022-12-12 19:53:02 | INFO | train_inner | {"epoch": 3, "update": 2.124, "loss": "2.914", "nll_loss": "0.114", "accuracy": "25", "wps": "5583.4", "ups": "6.85", "wpb": "815.4", "bsz": "32", "num_updates": "5300", "lr": "2.53731e-07", "gnorm": "2.967", "train_wall": "14", "wall": "773"}
2022-12-12 19:53:16 | INFO | train_inner | {"epoch": 3, "update": 2.164, "loss": "2.905", "nll_loss": "0.114", "accuracy": "23.7", "wps": "5799.8", "ups": "7.11", "wpb": "816.2", "bsz": "32", "num_updates": "5400", "lr": "2.38806e-07", "gnorm": "2.986", "train_wall": "14", "wall": "787"}
2022-12-12 19:53:30 | INFO | train_inner | {"epoch": 3, "update": 2.204, "loss": "2.896", "nll_loss": "0.114", "accuracy": "25.4", "wps": "6047.5", "ups": "7.41", "wpb": "815.8", "bsz": "32", "num_updates": "5500", "lr": "2.23881e-07", "gnorm": "2.948", "train_wall": "13", "wall": "800"}
2022-12-12 19:53:44 | INFO | train_inner | {"epoch": 3, "update": 2.244, "loss": "2.903", "nll_loss": "0.114", "accuracy": "24", "wps": "5656.4", "ups": "6.93", "wpb": "815.8", "bsz": "32", "num_updates": "5600", "lr": "2.08955e-07", "gnorm": "2.985", "train_wall": "14", "wall": "815"}
2022-12-12 19:53:58 | INFO | train_inner | {"epoch": 3, "update": 2.285, "loss": "2.913", "nll_loss": "0.114", "accuracy": "24.7", "wps": "5890.7", "ups": "7.23", "wpb": "815", "bsz": "32", "num_updates": "5700", "lr": "1.9403e-07", "gnorm": "2.905", "train_wall": "14", "wall": "829"}
2022-12-12 19:54:12 | INFO | train_inner | {"epoch": 3, "update": 2.325, "loss": "2.883", "nll_loss": "0.113", "accuracy": "26.1", "wps": "5887.8", "ups": "7.21", "wpb": "816.6", "bsz": "32", "num_updates": "5800", "lr": "1.79104e-07", "gnorm": "3.05", "train_wall": "14", "wall": "842"}
2022-12-12 19:54:26 | INFO | train_inner | {"epoch": 3, "update": 2.365, "loss": "2.906", "nll_loss": "0.114", "accuracy": "24.6", "wps": "5796.8", "ups": "7.11", "wpb": "815.5", "bsz": "32", "num_updates": "5900", "lr": "1.64179e-07", "gnorm": "3.001", "train_wall": "14", "wall": "857"}
2022-12-12 19:54:40 | INFO | train_inner | {"epoch": 3, "update": 2.405, "loss": "2.898", "nll_loss": "0.114", "accuracy": "25.3", "wps": "6071.6", "ups": "7.45", "wpb": "815.1", "bsz": "32", "num_updates": "6000", "lr": "1.49254e-07", "gnorm": "3.025", "train_wall": "13", "wall": "870"}
2022-12-12 19:54:53 | INFO | train_inner | {"epoch": 3, "update": 2.445, "loss": "2.889", "nll_loss": "0.113", "accuracy": "24.8", "wps": "5958.1", "ups": "7.31", "wpb": "814.8", "bsz": "32", "num_updates": "6100", "lr": "1.34328e-07", "gnorm": "3.053", "train_wall": "14", "wall": "884"}
2022-12-12 19:55:08 | INFO | train_inner | {"epoch": 3, "update": 2.485, "loss": "2.904", "nll_loss": "0.114", "accuracy": "24.3", "wps": "5806", "ups": "7.12", "wpb": "815.7", "bsz": "32", "num_updates": "6200", "lr": "1.19403e-07", "gnorm": "2.861", "train_wall": "14", "wall": "898"}
2022-12-12 19:55:21 | INFO | train_inner | {"epoch": 3, "update": 2.525, "loss": "2.842", "nll_loss": "0.111", "accuracy": "26", "wps": "6043.1", "ups": "7.4", "wpb": "817", "bsz": "32", "num_updates": "6300", "lr": "1.04478e-07", "gnorm": "2.922", "train_wall": "13", "wall": "911"}
2022-12-12 19:55:34 | INFO | train_inner | {"epoch": 3, "update": 2.565, "loss": "2.908", "nll_loss": "0.114", "accuracy": "24.9", "wps": "6127.5", "ups": "7.5", "wpb": "817", "bsz": "32", "num_updates": "6400", "lr": "8.95522e-08", "gnorm": "2.968", "train_wall": "13", "wall": "925"}
2022-12-12 19:55:48 | INFO | train_inner | {"epoch": 3, "update": 2.605, "loss": "2.872", "nll_loss": "0.113", "accuracy": "25.5", "wps": "6007.6", "ups": "7.35", "wpb": "816.9", "bsz": "32", "num_updates": "6500", "lr": "7.46269e-08", "gnorm": "2.96", "train_wall": "13", "wall": "938"}
2022-12-12 19:56:02 | INFO | train_inner | {"epoch": 3, "update": 2.645, "loss": "2.896", "nll_loss": "0.114", "accuracy": "25.7", "wps": "5817.7", "ups": "7.13", "wpb": "815.7", "bsz": "32", "num_updates": "6600", "lr": "5.97015e-08", "gnorm": "2.986", "train_wall": "14", "wall": "952"}
2022-12-12 19:56:16 | INFO | train_inner | {"epoch": 3, "update": 2.685, "loss": "2.872", "nll_loss": "0.113", "accuracy": "25.6", "wps": "5832.8", "ups": "7.15", "wpb": "816.1", "bsz": "32", "num_updates": "6700", "lr": "4.47761e-08", "gnorm": "2.88", "train_wall": "14", "wall": "966"}
2022-12-12 19:56:30 | INFO | train_inner | {"epoch": 3, "update": 2.725, "loss": "2.934", "nll_loss": "0.115", "accuracy": "23.8", "wps": "5912", "ups": "7.25", "wpb": "815.6", "bsz": "32", "num_updates": "6800", "lr": "2.98507e-08", "gnorm": "3.021", "train_wall": "14", "wall": "980"}
2022-12-12 19:56:44 | INFO | train_inner | {"epoch": 3, "update": 2.766, "loss": "2.894", "nll_loss": "0.113", "accuracy": "24.8", "wps": "5946.4", "ups": "7.28", "wpb": "817", "bsz": "32", "num_updates": "6900", "lr": "1.49254e-08", "gnorm": "2.979", "train_wall": "14", "wall": "994"}
2022-12-12 19:56:58 | INFO | train_inner | {"epoch": 3, "update": 2.806, "loss": "2.879", "nll_loss": "0.113", "accuracy": "25.4", "wps": "5948.5", "ups": "7.3", "wpb": "815.1", "bsz": "32", "num_updates": "7000", "lr": "0", "gnorm": "2.91", "train_wall": "14", "wall": "1008"}
2022-12-12 19:56:58 | INFO | fairseq_cli.train | Stopping training due to num_updates: 7000 >= max_update: 7000
2022-12-12 19:56:58 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-12-12 19:57:10 | INFO | valid | {"epoch": 3, "valid_loss": "2.89", "valid_nll_loss": "0.113", "valid_accuracy": "25.2", "valid_wps": "18019.3", "valid_wpb": "102.1", "valid_bsz": "4", "valid_num_updates": "7000", "valid_best_accuracy": "25.4"}
2022-12-12 19:57:10 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 3 @ 7000 updates
2022-12-12 19:57:13 | INFO | fairseq.trainer | Finished saving checkpoint to checkpoints/checkpoint_last_xai_apex_M2P_1e-6_small_tmp.pt.pt
2022-12-12 19:57:13 | INFO | fairseq.checkpoint_utils | Saved checkpoint checkpoints/checkpoint_last_xai_apex_M2P_1e-6_small_tmp.pt.pt (epoch 3 @ 7000 updates, score 25.2) (writing took 3.0275845360010862 seconds)
2022-12-12 19:57:13 | INFO | fairseq_cli.train | end of epoch 3 (average epoch stats below)
2022-12-12 19:57:14 | INFO | train | {"epoch": 3, "train_loss": "2.896", "train_nll_loss": "0.114", "train_accuracy": "25", "train_wps": "5567.7", "train_ups": "6.82", "train_wpb": "816", "train_bsz": "32", "train_num_updates": "7000", "train_lr": "0", "train_gnorm": "2.976", "train_train_wall": "275", "train_wall": "1023"}
2022-12-12 19:57:14 | INFO | fairseq_cli.train | done training in 1023.1 seconds
